Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency...
Update R version dependency from 4.1 to 4.5.0
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of metabom8... OK
Checking coding practice...
 Avoid T/F variables; If logical, use TRUE/FALSE 
Found 1 times:
T in R/plotscores.R (line 61, column 68)
Checking parsed R code in R directory, examples, vignettes...
Use accessors; don't access S4 class slots via '@' in examples/vignettes.
Checking function lengths...
The recommended function length is 50 lines or less. There are 32 functions greater than 50 lines.
The longest 5 functions are:
.finalisePlsModel() (R/pls.r): 206 lines
.permYmod() (R/AllGenerics.R): 120 lines
read1d_raw() (R/read1d_raw.R): 109 lines
plotscores() (R/plotscores.R):  98 lines
.detect1d_procs() (R/read1d.R):  92 lines
Checking man page documentation...
Consider adding runnable examples to man pages that document exported objects.
dot-scaleMatRcpp.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 795 lines (12%) are > 80 characters long.
First few lines:
R/alignSegment.R#L4 #' Aligns rows of an NMR spectral matrix ...
R/alignSegment.R#L5 #' Optionally uses the row-wise median s ...
R/alignSegment.R#L8 #' @param idx_ref Integer. Row index to  ...
R/alignSegment.R#L9 #' @param clim Numeric. Minimum cross-co ...
R/alignSegment.R#L10 #' @param med Logical. If \code{TRUE}, t ...
R/alignSegment.R#L11 #' @param norm Logical. If \code{TRUE},  ...
R/alignSegment.R#L13 #' @return A numeric matrix of aligned s ...
R/alignSegment.R#L17 #' Each spectrum is aligned to the refer ...
R/alignSegment.R#L19 #' This function is intended for fine-tu ...
R/alignSegment.R#L31 alignSegment <- function(seg, idx_ref =  ...
R/alignSegment.R#L32   if (!is.matrix(seg) || nrow(seg) < 2)  ...
R/AllClasses.R#L2 #' @description An S4 class to represent ...
R/AllClasses.R#L91 #   setMethod(genericName, "OPLS_metabom ...
R/AllGenerics.R#L6 #' @return A list: cleaned Y matrix, lev ...
R/AllGenerics.R#L45 #' @description Validates that input \co ...
R/AllGenerics.R#L47 #' @return \code{NULL} if all checks pas ...
R/AllGenerics.R#L52     stop(sprintf("Input X must be a nume ...
R/AllGenerics.R#L64 #' Checks that the input matrices \code{ ...
R/AllGenerics.R#L67 #' the number of variables (columns) in  ...
R/AllGenerics.R#L89 #' Determines whether an additional comp ...
R/AllGenerics.R#L91 #' AUROC is computed on cross-validation ...
R/AllGenerics.R#L94 #' @param type Character. Either 'R' for ...
R/AllGenerics.R#L95 #' @param q2s Numeric vector of \eqn{Q^2 ...
R/AllGenerics.R#L96 #' @param auroc_cv Numeric vector of AUR ...
R/AllGenerics.R#L100 #' \code{TRUE} if the current component  ...
R/AllGenerics.R#L122            if (nc > 1 && (diff(cv_est[(n ...
R/AllGenerics.R#L128            if (nc > 1 && (diff(cv_est[(n ...
R/AllGenerics.R#L141 #' @param k Integer. Number of CV folds. ...
R/AllGenerics.R#L146 #' A list of length \code{k}, where each ...
R/AllGenerics.R#L174 #' Generates a list of training set indi ...
R/AllGenerics.R#L175 #' Stratification is performed based on  ...
R/AllGenerics.R#L176 #' \code{Y} is binned by quantiles to em ...
R/AllGenerics.R#L182 #'   \item \code{type}: Character. Eithe ...
R/AllGenerics.R#L184 #'   \item \code{probs}: Numeric vector. ...
R/AllGenerics.R#L188 #' A list of length \code{k}, each eleme ...
R/AllGenerics.R#L189 #' Returns \code{NULL} and a warning if  ...
R/AllGenerics.R#L212       warning("Insufficient variability  ...
R/AllGenerics.R#L222     message("Skewed class distribution d ...
R/AllGenerics.R#L228     message(sprintf("Reducing k to %d du ...
R/AllGenerics.R#L253 #' @description Generates a list of trai ...
R/AllGenerics.R#L254 #' @param k Integer. Number of MCCV iter ...
R/AllGenerics.R#L255 #' @param Y A matrix (n x p), where rows ...
R/AllGenerics.R#L256 #' @param split Numeric. Fraction of the ...
R/AllGenerics.R#L257 #' @return A list of length \code{k}, ea ...
R/AllGenerics.R#L258 #' @details For each fold, a random samp ...
R/AllGenerics.R#L266   #   warning(sprintf("The 'k' parameter ...
R/AllGenerics.R#L279     message("Unusual value for 'split'.  ...
R/AllGenerics.R#L285     stop("Split results in zero training ...
R/AllGenerics.R#L297 #' @description Generates class/group-ba ...
R/AllGenerics.R#L299 #' @param split Numeric. Fraction of obs ...
R/AllGenerics.R#L302 #'     \item{1: } Character. Outcome typ ...
R/AllGenerics.R#L304 #'     \item{3: } Numeric vector of prob ...
R/AllGenerics.R#L306 #' @return A list of length \code{k}, ea ...
R/AllGenerics.R#L307 #' @details Each round samples a class-b ...
R/AllGenerics.R#L315   #   warning(sprintf("The k-fold parame ...
R/AllGenerics.R#L337       stop("Y has insufficient variabili ...
R/AllGenerics.R#L348     stop("Skewed class frequencies. Resu ...
R/AllGenerics.R#L354     stop("Insufficient observations in m ...
R/AllGenerics.R#L371 #' @description Generates a list of row  ...
R/AllGenerics.R#L373 #' @param Y matrix or data.frame. Outcom ...
R/AllGenerics.R#L374 #' @param type character. Type of analys ...
R/AllGenerics.R#L375 #' @param method character. One of: `"k- ...
R/AllGenerics.R#L377 #' @param split numeric. For Monte Carlo ...
R/AllGenerics.R#L379 #' @return A list of integer vectors. Ea ...
R/AllGenerics.R#L382 #' - In `"k-fold_stratified"` and `"MC_b ...
R/AllGenerics.R#L383 #' - If `type` is regression (`"R"`), qu ...
R/AllGenerics.R#L384 #' - If `type` is discriminant analysis  ...
R/AllGenerics.R#L386 .cvSetsMethod <- function(Y, type, metho ...
R/AllGenerics.R#L390     stop("Check method argument. Valid m ...
R/AllGenerics.R#L400     stop("Check method argument. Valid m ...
R/AllGenerics.R#L416                       `k-fold_stratified ...
R/AllGenerics.R#L419                       MC_balanced = .mcB ...
R/AllGenerics.R#L431 #' Converts a response vector \code{Y} i ...
R/AllGenerics.R#L435 #'   - If multiclass (>2 levels): return ...
R/AllGenerics.R#L436 #' Also returns a mapping between origin ...
R/AllGenerics.R#L443 #'   \item{\code{[[2]]}}{Data frame mapp ...
R/AllGenerics.R#L488 #' Performs orthogonal projections to la ...
R/AllGenerics.R#L489 #' The function fits one orthogonal and  ...
R/AllGenerics.R#L490 #' For the first orthogonal component (\ ...
R/AllGenerics.R#L491 #' For later components (\code{nc > 1}), ...
R/AllGenerics.R#L493 #' @param X Numeric matrix. Input data m ...
R/AllGenerics.R#L494 #' @param Y Numeric matrix. Response var ...
R/AllGenerics.R#L495 #' @param cv.set List of integer vectors ...
R/AllGenerics.R#L496 #'   These indices are adjusted internal ...
R/AllGenerics.R#L497 #' @param nc Integer. Component number c ...
R/AllGenerics.R#L498 #' @param mod.cv List. Model state to be ...
R/AllGenerics.R#L500 #' @return A list of the same length as  ...
R/AllGenerics.R#L502 #'   \item \code{t_xo}: Orthogonal compo ...
R/AllGenerics.R#L506 #'   \item \code{x_res}: Residual matrix ...
R/AllGenerics.R#L509 #' @note Training indices in \code{cv.se ...
R/AllGenerics.R#L536     Xcs <- if (nc == 1) .scaleMatRcpp(X, ...
R/AllGenerics.R#L539     opls_filt  <- .nipOplsRcpp(X = Xcs[i ...
R/AllGenerics.R#L540     pred_comp  <- .nipPlsCompRcpp(opls_f ...
R/AllGenerics.R#L543     opls_pred <- .oplsPredRcpp(opls_mod  ...
R/AllGenerics.R#L546     # opls_pred_tr <- .oplsPredRcpp(opls ...
R/AllGenerics.R#L566 #' Extracts a specific data structure (e ...
R/AllGenerics.R#L567 #' Depending on the cross-validation typ ...
R/AllGenerics.R#L570 #' Here, **Coverage** refers to the prop ...
R/AllGenerics.R#L571 #' (i.e., not missing), serving as an es ...
R/AllGenerics.R#L573 #' @param cv_obj Named list. Output of ` ...
R/AllGenerics.R#L574 #' @param feat Character. Feature name t ...
R/AllGenerics.R#L575 #' @param cv_type Character. Cross-valid ...
R/AllGenerics.R#L576 #' @param model_type Character. Indicate ...
R/AllGenerics.R#L580 #'   \item For Monte Carlo CV and single ...
R/AllGenerics.R#L581 #'   \item For Monte Carlo CV and multi- ...
R/AllGenerics.R#L582 #'   \item For k-fold CV: matrix or arra ...
R/AllGenerics.R#L590   ### feat t_xo -> can be more than sing ...
R/AllGenerics.R#L597   if (grepl("MC", cv_type) || (grepl("k- ...
R/AllGenerics.R#L612     #   ### this is not bivariate Y, but ...
R/AllGenerics.R#L613     #   # ned to make sure this is alway ...
R/AllGenerics.R#L638   if (grepl("MC", cv_type) || (grepl("k- ...
R/AllGenerics.R#L673 #' Computes the coefficient of determina ...
R/AllGenerics.R#L674 #' \deqn{R^2 = 1 - \frac{PRESS}{TSS}}, w ...
R/AllGenerics.R#L675 #' and TSS is the total sum of squares.  ...
R/AllGenerics.R#L677 #' This function supports matrix inputs  ...
R/AllGenerics.R#L680 #' @param Y Numeric matrix. True respons ...
R/AllGenerics.R#L682 #' @param ytss Numeric (optional). Total ...
R/AllGenerics.R#L713 #' Generates a tabular and graphical sum ...
R/AllGenerics.R#L714 #' Includes explained variance (\eqn{R^2 ...
R/AllGenerics.R#L716 #' For discriminant models (DA), AUROC v ...
R/AllGenerics.R#L718 #' @param type Character. Model type: ei ...
R/AllGenerics.R#L719 #' @param r2x_comp Numeric vector. Propo ...
R/AllGenerics.R#L720 #' @param r2_comp Numeric vector. Propor ...
R/AllGenerics.R#L721 #' @param q2_comp Numeric vector. Cross- ...
R/AllGenerics.R#L722 #' @param aucs_tr Numeric vector. AUROC  ...
R/AllGenerics.R#L724 #' @param cv List. Cross-validation conf ...
R/AllGenerics.R#L733 #' @importFrom ggplot2 ggplot geom_bar a ...
R/AllGenerics.R#L737 .orthModelCompSummary <- function(type,  ...
R/AllGenerics.R#L774     cv_text <- paste0('\nCross validatio ...
R/AllGenerics.R#L777   g <- ggplot2::ggplot(mm, ggplot2::aes( ...
R/AllGenerics.R#L778     ggplot2::geom_bar(stat = "identity", ...
R/AllGenerics.R#L780       values = c(R2X = "#1b9e77", R2Y =  ...
R/AllGenerics.R#L813     g <- g + ggplot2::scale_y_continuous ...
R/AllGenerics.R#L815     g <- g + ggplot2::scale_y_continuous ...
R/AllGenerics.R#L825 #' Includes explained variance in X Spac ...
R/AllGenerics.R#L827 #' For discriminant models (DA), AUROC v ...
R/AllGenerics.R#L829 #' @param type Character. Model type: ei ...
R/AllGenerics.R#L830 #' @param r2x_comp Numeric vector. Propo ...
R/AllGenerics.R#L831 #' @param r2_comp Numeric vector. Propor ...
R/AllGenerics.R#L832 #' @param q2_comp Numeric vector. Cross- ...
R/AllGenerics.R#L833 #' @param aucs_tr Numeric vector. in-sam ...
R/AllGenerics.R#L834 #' @param aucs_te Numeric vector. out-of ...
R/AllGenerics.R#L844 #' @importFrom ggplot2 ggplot geom_bar a ...
R/AllGenerics.R#L848 .plsModelCompSummary <- function(type, r ...
R/AllGenerics.R#L882     cv_text <- paste0('\nCross validatio ...
R/AllGenerics.R#L885   g <- ggplot2::ggplot(mm, ggplot2::aes( ...
R/AllGenerics.R#L886     ggplot2::geom_bar(stat = "identity", ...
R/AllGenerics.R#L888       values = c(R2X = "lightgreen", R2Y ...
R/AllGenerics.R#L921     g <- g + ggplot2::scale_y_continuous ...
R/AllGenerics.R#L923     g <- g + ggplot2::scale_y_continuous ...
R/AllGenerics.R#L934 #' Validates that the NMR data matrix an ...
R/AllGenerics.R#L941 #' This function is typically used as a  ...
R/AllGenerics.R#L943 #' @param X Numeric matrix. NMR spectral ...
R/AllGenerics.R#L944 #' @param ppm Numeric vector. Chemical s ...
R/AllGenerics.R#L946 #' @return Logical. Returns \code{TRUE}  ...
R/AllGenerics.R#L961 #' Ensures that the input object `X` is  ...
R/AllGenerics.R#L965 #' @param X Numeric vector, matrix, or a ...
R/AllGenerics.R#L967 #' @return A numeric matrix with one row ...
R/AllGenerics.R#L978 #' Returns the indices of the chemical s ...
R/AllGenerics.R#L980 #' @param range Numeric vector of length ...
R/AllGenerics.R#L983 #' @return Integer vector of indices cor ...
R/AllGenerics.R#L1004   warning("`get.idx` is deprecated and w ...
R/AllGenerics.R#L1012 #' This is a generalized form of min-max ...
R/AllGenerics.R#L1015 #' @param ra Numeric vector of length 2. ...
R/AllGenerics.R#L1017 #' @return A numeric vector of the same  ...
R/AllGenerics.R#L1021 #' \deqn{x_{scaled} = \frac{x - \min(x)} ...
R/AllGenerics.R#L1026 #' points(scRange(x, ra = c(5, 10)), typ ...
R/AllGenerics.R#L1043 #' @return A numeric vector of the same  ...
R/AllGenerics.R#L1076 #' @param X Numeric matrix. NMR spectral ...
R/AllGenerics.R#L1077 #' @param ppm Numeric vector. Chemical s ...
R/AllGenerics.R#L1078 #' @param shift Numeric vector of length ...
R/AllGenerics.R#L1079 #' @param sf Numeric scalar. Spectromete ...
R/AllGenerics.R#L1088 #' This is commonly used as part of tech ...
R/AllGenerics.R#L1092 #' The chemical shift axis direction is  ...
R/AllGenerics.R#L1145 #' Estimates the noise level for each sp ...
R/AllGenerics.R#L1146 #' Useful for quality control (QC) befor ...
R/AllGenerics.R#L1148 #' @param X Numeric matrix. NMR data wit ...
R/AllGenerics.R#L1149 #' @param ppm Numeric vector. Chemical s ...
R/AllGenerics.R#L1150 #' @param where Numeric vector of length ...
R/AllGenerics.R#L1151 #'   This range should be free of peaks  ...
R/AllGenerics.R#L1154 #' Noise is estimated after baseline cor ...
R/AllGenerics.R#L1155 #' (via \code{\link[ptw]{asysm}}). The o ...
R/AllGenerics.R#L1156 #' region and assumes a minimum of 50 po ...
R/AllGenerics.R#L1158 #' @return Numeric vector of noise level ...
R/AllGenerics.R#L1161 #' Signal-free regions are typically at  ...
R/AllGenerics.R#L1178     stop("Insufficient number of points  ...
R/AllGenerics.R#L1194 #' Helper function to extract and struct ...
R/AllGenerics.R#L1197 #' @param pc Character vector indicating ...
R/AllGenerics.R#L1198 #' @param an Named list of annotation ve ...
R/AllGenerics.R#L1199 #' @param type Character. One of `"p"` ( ...
R/AllGenerics.R#L1203 #'   \item \code{df}: A data frame conta ...
R/AllGenerics.R#L1208 #' Used internally for constructing inpu ...
R/AllGenerics.R#L1256       com[[i]] <- if (grepl("o", pc[i])) ...
R/AllGenerics.R#L1282 #' Internal consistency check for princi ...
R/AllGenerics.R#L1284 #' @param pc Character or numeric. Selec ...
R/AllGenerics.R#L1287 #' @param type Character. Type of compon ...
R/AllGenerics.R#L1302     if (max(pc) > ncol(mod@p)) stop("PC  ...
R/AllGenerics.R#L1317         stop("Predictive component index ...
R/AllGenerics.R#L1330 #' Computes backscaled loadings for visu ...
R/AllGenerics.R#L1333 #' @param pc Character or numeric. Princ ...
R/AllGenerics.R#L1334 #' @param idx Integer vector. Indices de ...
R/AllGenerics.R#L1345 #' Backscaling is computed as: \code{p_b ...
R/AllGenerics.R#L1354   p_bs <- p_mod$df[, 1] * mod@X_sd       ...
R/AllGenerics.R#L1355   p_abs <- minmax(abs(p_mod$df[, 1]))    ...
R/AllGenerics.R#L1366 #' Computes the correlation and covarian ...
R/AllGenerics.R#L1367 #' This is typically used to reconstruct ...
R/AllGenerics.R#L1370 #' @param pc Character or numeric. Compo ...
R/AllGenerics.R#L1372 #' @param idx Integer vector. Indices sp ...
R/AllGenerics.R#L1377 #'   \item{cor}{Absolute correlation bet ...
R/AllGenerics.R#L1383 #' Correlations are computed as Pearson  ...
R/AllGenerics.R#L1384 #' Covariances are similarly computed. T ...
R/AllGenerics.R#L1387 #' # df <- .load_stat_reconstr_nmr(model ...
R/AllGenerics.R#L1404 #' Helper function to validate and forma ...
R/AllGenerics.R#L1405 #' Ensures that the input is a named lis ...
R/AllGenerics.R#L1407 #' @param an A list of annotation variab ...
R/AllGenerics.R#L1408 #'   If missing, defaults to the origina ...
R/AllGenerics.R#L1409 #' @param obj A \code{PCA_metabom8} or \ ...
R/AllGenerics.R#L1411 #' @return A cleaned and named list suit ...
R/AllGenerics.R#L1414 #' If annotation names are missing or du ...
R/AllGenerics.R#L1445     names(an)[dup_names] <- paste0(names ...
R/AllGenerics.R#L1460 #' Performs OPLS modeling on permuted Y  ...
R/AllGenerics.R#L1461 #' Extracts predictive performance (R2,  ...
R/AllGenerics.R#L1465 #' @param cv List. Cross-validation para ...
R/AllGenerics.R#L1466 #' @param type Character. Model type: \c ...
R/AllGenerics.R#L1473 #'   \item \code{aucs_tr}: Numeric, AURO ...
R/AllGenerics.R#L1474 #'   \item \code{aucs_te}: Numeric, AURO ...
R/AllGenerics.R#L1478 #' When \code{nc_o > 1}, the function fi ...
R/AllGenerics.R#L1479 #' Classification performance is compute ...
R/AllGenerics.R#L1498   preds_test <- .extMeanCvFeat(cv_obj =  ...
R/AllGenerics.R#L1499   preds_train <- .extMeanCvFeat(tt, feat ...
R/AllGenerics.R#L1514         Y_vec <- factor(apply(Y, 1, func ...
R/AllGenerics.R#L1516         auc_te <- multiclass.roc(respons ...
R/AllGenerics.R#L1517         auc_tr <- multiclass.roc(respons ...
R/AllGenerics.R#L1520         auc_te <- roc(response = Y_vec,  ...
R/AllGenerics.R#L1521         auc_tr <- roc(response = Y_vec,  ...
R/AllGenerics.R#L1525       list(q2 = .r2(Y, preds_test, NULL) ...
R/AllGenerics.R#L1530         Y_vec <- factor(apply(Y, 1, func ...
R/AllGenerics.R#L1532         auc_te <- multiclass.roc(respons ...
R/AllGenerics.R#L1533         auc_tr <- multiclass.roc(respons ...
R/AllGenerics.R#L1536         auc_te <- roc(response = Y_vec,  ...
R/AllGenerics.R#L1537         auc_tr <- roc(response = Y_vec,  ...
R/AllGenerics.R#L1541       list(q2 = .r2(Y, preds_test, NULL) ...
R/AllGenerics.R#L1575   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1579   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1582   #       mod <- roc(response = as.vecto ...
R/AllGenerics.R#L1584   #       mod <- roc(response = as.vecto ...
R/AllGenerics.R#L1601   # return(list(r2_comp = r2_comp, q2_co ...
R/AllGenerics.R#L1611 #' if all non-missing elements convert w ...
R/AllGenerics.R#L1612 #' It catches warnings and errors during ...
R/AllGenerics.R#L1614 #' @return Logical \code{TRUE} if \code{ ...
R/AllViz.R#L8 #' @param shift Numeric length-2 vector. ...
R/AllViz.R#L9 #' @param interactive Logical. Use plotl ...
R/AllViz.R#L11 #' @param mode Character. Plotly trace m ...
R/AllViz.R#L14 #' @param ... Additional arguments passe ...
R/AllViz.R#L16 #' @return If \code{interactive = TRUE}, ...
R/AllViz.R#L29 #' spec(X[3, ], ppm, shift = c(0, 11), i ...
R/AllViz.R#L31 spec <- function(x, ppm, shift = c(0, 11 ...
R/AllViz.R#L42     plotly::plot_ly(x = ~ppm_sub, y = ~x ...
R/AllViz.R#L64 #' Plots multiple 1D NMR spectra using e ...
R/AllViz.R#L68 #' @param shift Numeric vector of length ...
R/AllViz.R#L69 #' @param interactive Logical. Use plotl ...
R/AllViz.R#L70 #' @param ... Additional arguments passe ...
R/AllViz.R#L72 #' @return A \code{plotly} object if \co ...
R/AllViz.R#L116   graphics::matplot(ppm_sub, t(X_sub), t ...
R/AllViz.R#L126 #' Overlay multiple NMR spectra in a spe ...
R/AllViz.R#L127 #' Faceting, coloring, and line types ca ...
R/AllViz.R#L131 #' @param ppm Numeric vector. Chemical s ...
R/AllViz.R#L132 #' @param shift Numeric vector of length ...
R/AllViz.R#L133 #' @param an Named list of 1–3 elements  ...
R/AllViz.R#L142 #' The first element in `an` defines the ...
R/AllViz.R#L143 #' elements define coloring and line typ ...
R/AllViz.R#L153 #' @importFrom ggplot2 ggplot geom_line  ...
R/AllViz.R#L158 specOverlay <- function(X, ppm, shift =  ...
R/AllViz.R#L172   df <- data.frame(do.call(cbind.data.fr ...
R/AllViz.R#L179                              breaks = se ...
R/AllViz.R#L184            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L189            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L192              g <- g + ggplot2::scale_col ...
R/AllViz.R#L197            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L198                                          ...
R/AllViz.R#L201              g <- g + ggplot2::scale_col ...
R/AllViz.R#L206     ggplot2::scale_y_continuous(breaks = ...
R/AllViz.R#L222 #' This function overlays loadings from  ...
R/AllViz.R#L223 #' It supports two types of loadings vis ...
R/AllViz.R#L226 #' @param shift Numeric vector (length 2 ...
R/AllViz.R#L228 #' @param type Character. Either `"Stati ...
R/AllViz.R#L229 #' @param an List of up to three groupin ...
R/AllViz.R#L233 #' @param r_scale Logical. If `TRUE`, co ...
R/AllViz.R#L236 #' - **Statistical reconstruction**: Cor ...
R/AllViz.R#L251 #' @importFrom ggplot2 ggplot geom_line  ...
R/AllViz.R#L291   df <- data.frame(ID = seq_len(nrow(spe ...
R/AllViz.R#L310     geom_line(data = df1, aes(x=!!sym("p ...
R/AllViz.R#L312     geom_line(data = df, aes(x=!!sym("va ...
R/AllViz.R#L315     scale_x_reverse(breaks = round(seq(s ...
R/AllViz.R#L325                                   name = ...
R/AllViz.R#L330                                   limits ...
R/AllViz.R#L339 #' Overlay PCA or OPLS loadings on the p ...
R/AllViz.R#L340 #' or backscaling, providing insights in ...
R/AllViz.R#L342 #' @param mod A PCA or OPLS model object ...
R/AllViz.R#L343 #' @param shift Numeric vector of length ...
R/AllViz.R#L345 #' @param type Character. Either `"Stati ...
R/AllViz.R#L347 #' @param r_scale Logical. If `TRUE`, co ...
R/AllViz.R#L351 #' - **Statistical reconstruction** visu ...
R/AllViz.R#L352 #' - **Backscaled** multiplies loadings  ...
R/AllViz.R#L398     g <- ggplot(df, aes(x=!!sym("ppm"),  ...
R/AllViz.R#L401       scale_colour_gradientn(colors = ma ...
R/AllViz.R#L406         caption = paste(gsub("_metabom8" ...
R/AllViz.R#L412     g <- ggplot(df, aes(x=!!sym("ppm"),  ...
R/AllViz.R#L415       scale_colour_gradientn(colors = ma ...
R/AllViz.R#L420         caption = paste(gsub("_metabom8" ...
R/AllViz.R#L432 #' Calculates the orthogonal distance of ...
R/AllViz.R#L435 #' @param plot Logical. If \code{TRUE},  ...
R/AllViz.R#L445 #' DModX is calculated as the scaled roo ...
R/AllViz.R#L495       geom_segment(aes(xend = ID, yend = ...
R/AllViz.R#L514       g <- g + scale_colour_gradientn(co ...
R/binning.R#L4 #' @param ppm num array, chemical shift  ...
R/binning.R#L6 #' @param npoints num, desired number of ...
R/binning.R#L7 #' @details Equidistant binning of spect ...
R/binning.R#L8 #' @return Numeric matrix with spectra i ...
R/binning.R#L23   if (is.null(ppm) && (is.matrix(X) || i ...
R/binning.R#L27       stop("Non-matching dimensions X ma ...
R/binning.R#L35     stop("Please specify one or the othe ...
R/binning.R#L43       stop("Bin width equals or is small ...
R/binning.R#L74       stop("Input variable npoints canno ...
R/bline.R#L4 #' Non-linear baseline correction for NM ...
R/bline.R#L7 #' @param lambda Numeric. Smoothing para ...
R/bline.R#L8 #' @param iter_max Integer. Maximum numb ...
R/bline.R#L10 #' @return A numeric matrix of the same  ...
R/bline.R#L13 #' Missing values in \code{X} are replac ...
R/bline.R#L24 #' spec(X_bc[1, ], ppm, shift = c(3, 4), ...
R/bline.R#L35     warning("`bline` will be removed in  ...
R/calibrate_doub.R#L3 #' Calibrate 1D NMR spectra to a doublet ...
R/calibrate_doub.R#L6 #' @param ppm Numeric vector. Chemical s ...
R/calibrate_doub.R#L7 #' @param type Character or numeric. Use ...
R/calibrate_doub.R#L8 #' @param j_const Numeric vector. Expect ...
R/calibrate_doub.R#L18 .calibrate_doub <- function(X, ppm, type ...
R/calibrate_doub.R#L40     smoothed <- sgolayfilt(x - asysm(x,  ...
R/calibrate.R#L6 #' @param X Numeric matrix. NMR data mat ...
R/calibrate.R#L7 #' @param ppm Numeric vector. Chemical s ...
R/calibrate.R#L10 #'   \item{\code{"tsp"}: calibrates to 0 ...
R/calibrate.R#L11 #'   \item{\code{"glucose"}: calibrates  ...
R/calibrate.R#L12 #'   \item{\code{"alanine"}: calibrates  ...
R/calibrate.R#L13 #'   \item{Numeric vector of length 2: c ...
R/calibrate.R#L16 #' @return A numeric matrix of the same  ...
R/calibrate.R#L19 #' Calibration is typically part of the  ...
R/calibrate.R#L22 #' Dona, A.C., \emph{et al.} (2014). Pre ...
R/calibrate.R#L50     stop("If 'type' is a character, it m ...
R/calibrate.R#L54     stop("If 'type' is numeric, it must  ...
R/calibrate.R#L66     if (length(idx) == 0) stop("No ppm v ...
R/calibrate.R#L85     stop("Unsupported type argument. Mus ...
R/cvanova.R#L3 #' Performs a cross-validated ANOVA (CV- ...
R/cvanova.R#L5 #' @param smod An object of class \code{ ...
R/cvanova.R#L8 #' CV-ANOVA formally compares the fit of ...
R/cvanova.R#L13 #' Here, \eqn{Y_i} is the response for o ...
R/cvanova.R#L14 #' The residual sums of squares (SS) and ...
R/cvanova.R#L16 #' Please note: larger sample sizes incr ...
R/cvanova.R#L28 #' Eriksson, L., et al. (2008). CV-ANOVA ...
R/cvanova.R#L43 #' # where Y is the response variable an ...
R/data.R#L3 #' 1D proton NMR spectra from SARS-CoV-2 ...
R/data.R#L4 #' collected in Perth, Western Australia ...
R/data.R#L5 #' regions excised, baseline corrected,  ...
R/data.R#L7 #' FIDs were acquired with a standard 90 ...
R/data.R#L8 #' spectrometer using IVDr methods for b ...
R/data.R#L26 #' 1D proton NMR spectra from SARS-CoV-2 ...
R/data.R#L27 #' collected in a research study in Pert ...
R/data.R#L30 #' FIDs were acquired using a Carr–Purce ...
R/data.R#L31 #' Avance II spectrometer using IVDr met ...
R/data.R#L32 #' equipped with a double-resonance broa ...
R/eruption.R#L4 #' Generates an eruption plot to visuali ...
R/eruption.R#L5 #' Variables are plotted by their model  ...
R/eruption.R#L6 #' effect size (Cliff's delta), and adju ...
R/eruption.R#L8 #' @param mod An OPLS model object of cl ...
R/eruption.R#L9 #' @param pc Integer or character. Compo ...
R/eruption.R#L11 #' @param p_adj Character string. Method ...
R/eruption.R#L12 #' @param invert_es Logical. If \code{TR ...
R/eruption.R#L16 #'   \item{\code{data}}{A \code{data.fra ...
R/eruption.R#L21 #' Designed for binary classification OP ...
R/eruption.R#L22 #' and variable-level p-values are obtai ...
R/eruption.R#L23 #' of (adjusted) p-values. This plot is  ...
R/eruption.R#L27 #' Eriksson, L. et al. (2008). CV-ANOVA  ...
R/eruption.R#L105   gl2 <- ggplot(ddl, aes(x = !!sym("Cd") ...
R/eruption.R#L106     geom_label_repel(aes(label = !!sym(" ...
R/es_cdelta.R#L4 #' Calculates Cliff's delta, a non-param ...
R/es_cdelta.R#L17 #' The effect size is calculated as the  ...
R/es_cdelta.R#L21 #' Cliff, N. (1993). Dominance statistic ...
R/es_cdelta.R#L22 #' \emph{Psychological Bulletin}, 114(3) ...
R/es_cdelta.R#L49   delta <- (sum(dominance[1, ]) - sum(do ...
R/excise1d.R#L4 #' Removes standard chemical shift regio ...
R/excise1d.R#L6 #' @param X Numeric matrix. NMR spectra  ...
R/excise1d.R#L7 #' @param ppm Numeric vector. Chemical s ...
R/excise1d.R#L20 #'   \item \code{Xc}: Numeric matrix wit ...
R/excise1d.R#L36   if (ncol(X) != length(ppm)) stop("ppm  ...
R/hotellingsT2.R#L3 #' @description Computes the Hotelling's ...
R/hotellingsT2.R#L9 #' @return A \code{data.frame} with two  ...
R/hotellingsT2.R#L12 #' Geladi, P. and Kowalski, B.R. (1986). ...
R/hotellingsT2.R#L23   if (length(x) < 3) stop("At least 3 ob ...
R/normErectic.R#L4 #' This function normalizes 1D NMR spect ...
R/normErectic.R#L6 #' @param X Numeric matrix. NMR data wit ...
R/normErectic.R#L7 #' @param integr Logical. If \code{TRUE} ...
R/normErectic.R#L11 #'   \item If \code{integr = TRUE}: nume ...
R/normErectic.R#L12 #'   \item If \code{integr = FALSE}: num ...
R/normErectic.R#L16 #' The function identifies the dominant  ...
R/normErectic.R#L35   if (is.null(ppm) || any(is.na(ppm)) || ...
R/opls_perm.R#L4 #' Performs Y-permutation tests to asses ...
R/opls_perm.R#L8 #' @param plot Logical. If \code{TRUE},  ...
R/opls_perm.R#L9 #' @param mc Logical. If \code{TRUE}, en ...
R/opls_perm.R#L11 #' @return A \code{data.frame} with mode ...
R/opls_perm.R#L14 #' Each permutation shuffles the respons ...
R/opls_perm.R#L17 #' Wiklund, S. et al. (2008). A Tool for ...
R/opls_perm.R#L71     real_stats <- data.frame(r2_comp=NA_ ...
R/opls_perm.R#L73     real_stats <- data.frame(r2_comp=mod ...
R/opls_perm.R#L86       dd <- reshape2::melt(out_df[,c('au ...
R/opls_perm.R#L89       dd <- reshape2::melt(out_df[, c('r ...
R/opls_perm.R#L96     map_parameter <- c(aucs_tr = "AUROC_ ...
R/opls_perm.R#L98     # ylab <- if (any(grepl("AU", dd$var ...
R/opls_perm.R#L102     g <- ggplot(dd, aes(x = !!sym("r_abs ...
R/opls.R#L4 #' #' Fits an Orthogonal Projections to  ...
R/opls.R#L5 #' #' The number of orthogonal component ...
R/opls.R#L6 #' #' To avoid underfitting, components  ...
R/opls.R#L7 #' that each new component improves pred ...
R/opls.R#L8 #' This ensures the model captures relev ...
R/opls.R#L10 #' @param X Numeric matrix or data frame ...
R/opls.R#L11 #' @param Y Response variable. Vector or ...
R/opls.R#L13 #' @param scale Character. Scaling metho ...
R/opls.R#L14 #' @param cv Named list specifying cross ...
R/opls.R#L15 #' @param maxPCo Integer. Maximum number ...
R/opls.R#L46   class_memb <- if (is_multi_Y) sub("^Nu ...
R/opls.R#L50   XcsTot <- .scaleMatRcpp(inputs$X, 0:(n ...
R/opls.R#L51   YcsTot <- .scaleMatRcpp(inputs$Y, 0:(n ...
R/opls.R#L61     tt <- if (nc == 1) .oplsComponentCv( ...
R/opls.R#L64     preds_test <- .extMeanCvFeat(tt, fea ...
R/opls.R#L65     preds_train <- .extMeanCvFeat(tt, fe ...
R/opls.R#L67     perf <- .evalComponentPerformance(st ...
R/opls.R#L87       pred_comp <- .nipPlsCompRcpp(opls_ ...
R/opls.R#L88       r2x_comp[nc - 1] <- .r2(opls_filt$ ...
R/opls.R#L92       message(sprintf("An O-PLS-%s model ...
R/opls.R#L93       pred_comp$t_o_cv <- matrix(.extMea ...
R/opls.R#L94       pred_comp$t_cv <- matrix(.extMeanC ...
R/opls.R#L148   cv$cv_sets <- .cvSetsMethod(Y, type, m ...
R/opls.R#L154 .evalComponentPerformance <- function(cv ...
R/opls.R#L159         auc_te <- multiclass.roc(respons ...
R/opls.R#L160         auc_tr <- multiclass.roc(respons ...
R/opls.R#L162         auc_te <- roc(response = Y, pred ...
R/opls.R#L163         auc_tr <- roc(response = Y, pred ...
R/opls.R#L167       list(q2 = .r2(YcsTot, preds_test,  ...
R/opls.R#L173         auc_te <- multiclass.roc(respons ...
R/opls.R#L174         auc_tr <- multiclass.roc(respons ...
R/opls.R#L176         auc_te <- roc(response = Y, pred ...
R/opls.R#L177         auc_tr <- roc(response = Y, pred ...
R/opls.R#L181       list(q2 = .r2(YcsTot, preds_test,  ...
R/pca.R#L4 #' Performs Principal Component Analysis ...
R/pca.R#L6 #' @param X A numeric matrix or \code{da ...
R/pca.R#L7 #' @param pc Integer. The number of prin ...
R/pca.R#L8 #' @param scale Character. Scaling metho ...
R/pca.R#L9 #' @param center Logical. Whether to mea ...
R/pca.R#L10 #' @param method Character. Algorithm to ...
R/pca.R#L13 #' The default \code{"nipals"} method us ...
R/pca.R#L22 #'   \item \code{Parameters}: A list of  ...
R/pca.R#L27 #' Geladi, P., & Kowalski, B. R. (1986). ...
R/pca.R#L35 #' plotscores(model, an = list(Class = a ...
R/pca.R#L51     warning("Too many components request ...
R/pca.R#L63   XcsTot <- .scaleMatRcpp(X, 0:(nrow(X)  ...
R/pca.R#L70       res[[i]] <- if (i == 1) .nipPcaCom ...
R/pca.R#L79     pars <- list(center = center, scale  ...
R/pca.R#L91     mod <- pcaMethods::pca(X, nPcs = pc, ...
R/plotscores.R#L2 #' @description Generate score plots for ...
R/plotscores.R#L4 #' @param obj A fitted model object of c ...
R/plotscores.R#L5 #' @param pc Numeric or character vector ...
R/plotscores.R#L6 #' @param an Optional list of up to 3 el ...
R/plotscores.R#L8 #' @param qc Optional integer vector of  ...
R/plotscores.R#L9 #' @param legend Character. Legend posit ...
R/plotscores.R#L10 #' @param cv Logical. If \code{TRUE}, cr ...
R/plotscores.R#L11 #' @param ... Additional arguments passe ...
R/plotscores.R#L16 #' Trygg J., Wold S. (2002) Orthogonal p ...
R/plotscores.R#L17 #' Hotelling H. (1931) The generalizatio ...
R/plotscores.R#L19 #' @importFrom ggplot2 ggplot aes geom_p ...
R/plotscores.R#L35 plotscores <- function(obj, pc, an, titl ...
R/plotscores.R#L48   type <- if (ncol(sc) > 2 && is.numeric ...
R/plotscores.R#L50   if (is.null(res$an_le) || is.na(res$an ...
R/plotscores.R#L61     labs(caption = expression("Dashed li ...
R/plotscores.R#L75     g <- g + scale_colour_gradientn(colo ...
R/plotscores.R#L87     g <- g + geom_point(data = df_qc, ae ...
R/plotscores.R#L93                 g + scale_x_continuous(n ...
R/plotscores.R#L94                   scale_y_continuous(nam ...
R/plotscores.R#L100                   # labs(title = paste0( ...
R/plotscores.R#L101                   #                      ...
R/plotscores.R#L102                   #                      ...
R/plotscores.R#L103                   #                      ...
R/plotscores.R#L105                   labs(title = paste0("O ...
R/plotscores.R#L106                                       "  ...
R/plotscores.R#L107                                       if ...
R/plotscores.R#L113                 g + scale_x_continuous(n ...
R/plotscores.R#L114                   scale_y_continuous(nam ...
R/plotscores.R#L116                                       "  ...
R/plotscores.R#L117                                       if ...
R/plotscores.R#L126     g <- g + theme(legend.position.insid ...
R/pls.r#L2 #' @description Fit a Partial Least Squa ...
R/pls.r#L4 #' @param X A numeric matrix or data fra ...
R/pls.r#L5 #' @param Y Response vector or matrix. M ...
R/pls.r#L7 #' @param scale Character. Scaling metho ...
R/pls.r#L10 #'     \item{\code{method}}{Cross-valida ...
R/pls.r#L11 #'     \item{\code{split}}{Fraction of o ...
R/pls.r#L15 #' @param plotting Logical. If \code{TRU ...
R/pls.r#L18 #' Cross-validation is used to select th ...
R/pls.r#L20 #' @return An object of class \code{PLS_ ...
R/pls.r#L23 #' Geladi, P. & Kowalski, B.R. (1986). P ...
R/pls.r#L31 #' plotscores(model, an = list(Class = a ...
R/pls.r#L77   .finalisePlsModel(fit$full_mod, prep$X ...
R/pls.r#L96   Xcs <- .scaleMatRcpp(X, 0:(nrow(X) - 1 ...
R/pls.r#L97   Ycs <- .scaleMatRcpp(y_check[[1]], 0:( ...
R/pls.r#L113   cv_sets <- .cvSetsMethod(Y = Y_, type  ...
R/pls.r#L122       .plsComponentCv(Xcs, Y = Y_, cv_se ...
R/pls.r#L127     preds_test <- .extMeanCvFeat_alt(mod ...
R/pls.r#L128     preds_train <- .extMeanCvFeat_alt(mo ...
R/pls.r#L130     perf <- .evaluatePlsPerformance(type ...
R/pls.r#L159 .evaluatePlsPerformance <- function(type ...
R/pls.r#L170         result$auc_te <- multiclass.roc( ...
R/pls.r#L171         result$auc_tr <- multiclass.roc( ...
R/pls.r#L173         if (length(dim(preds_test)) == 2 ...
R/pls.r#L174         result$auc_te <- roc(response =  ...
R/pls.r#L175         if (length(dim(preds_train)) ==  ...
R/pls.r#L176         result$auc_tr <- roc(response =  ...
R/pls.r#L186 .finalisePlsModel <- function(mod_list,  ...
R/pls.r#L195   Y_res <- YcsTot - (mod_list[[length(mo ...
R/pls.r#L237 #   if (is.null(sc_num)) stop("Invalid ' ...
R/pls.r#L246 #   XcsTot <- .scaleMatRcpp(X, 0:(nrow(X ...
R/pls.r#L247 #   YcsTot <- .scaleMatRcpp(y_check[[1]] ...
R/pls.r#L252 #   cv$cv_sets <- .cvSetsMethod(Y = y_ch ...
R/pls.r#L263 #       tt <- .plsComponentCv(X, Y = y_c ...
R/pls.r#L265 #       tt <- .plsComponentCv(X = NA, Y  ...
R/pls.r#L268 #     # preds_test <- .extMeanCvFeat_pls ...
R/pls.r#L269 #     # preds_train <- .extMeanCvFeat_pl ...
R/pls.r#L271 #     preds_test <- .extMeanCvFeat_alt(c ...
R/pls.r#L273 #     preds_train <- .extMeanCvFeat_alt( ...
R/pls.r#L276 #       error('outcome of cv routine: le ...
R/pls.r#L280 #       error('outcome of cv routine: in ...
R/pls.r#L289 #                  aucs_te[nc] <- multic ...
R/pls.r#L293 #                  aucs_tr[nc] <- multic ...
R/pls.r#L295 #                  aucs_te[nc] <- roc(re ...
R/pls.r#L296 #                  aucs_tr[nc] <- roc(re ...
R/pls.r#L307 #                  aucs_te[nc] <- multic ...
R/pls.r#L310 #                  aucs_tr[nc] <- multic ...
R/pls.r#L312 #                  aucs_te[nc] <- roc(re ...
R/pls.r#L313 #                  aucs_tr[nc] <- roc(re ...
R/pls.r#L333 #       r2xc <- .r2(XcsTot, (full_mod[[c ...
R/pls.r#L344 #   mod_summary <- .plsModelCompSummary( ...
R/pls.r#L356 #   Y_res <- YcsTot - (full_mod[[length( ...
R/plsComponentCv.R#L2 #' @description Performs Partial Least S ...
R/plsComponentCv.R#L4 #' @param X Numeric matrix. Predictor ma ...
R/plsComponentCv.R#L5 #' @param Y Numeric matrix. Response mat ...
R/plsComponentCv.R#L6 #' @param cv.set List of integer vectors ...
R/plsComponentCv.R#L8 #' @param mod.cv List or NULL. Existing  ...
R/plsComponentCv.R#L10 #' @return A named list of matrices cont ...
R/plsComponentCv.R#L25     pred_comp <- .nipPlsCompRcpp(X = Xcs ...
R/ppick.R#L4 #' Identifies local maxima, minima, or b ...
R/ppick.R#L6 #' @param X Numeric matrix. NMR data wit ...
R/ppick.R#L7 #' @param ppm Numeric vector. Chemical s ...
R/ppick.R#L9 #' @param fil_n Integer. Filter length ( ...
R/ppick.R#L10 #' @param type Character. Type of extrem ...
R/ppick.R#L13 #' The spectra are smoothed using a Savi ...
R/ppick.R#L21 #'   \item \code{Etype}: Extrema type: \ ...
R/pqn.R#L4 #' Applies probabilistic quotient normal ...
R/pqn.R#L6 #' @param X A numeric matrix or data.fra ...
R/pqn.R#L7 #' @param iref Integer vector of row ind ...
R/pqn.R#L8 #' @param TArea Logical. If \code{TRUE}, ...
R/pqn.R#L9 #' @param add_DilF Character. Name of gl ...
R/pqn.R#L10 #' @param bin Optional named list for bi ...
R/pqn.R#L13 #' PQN accounts for sample dilution effe ...
R/pqn.R#L15 #' Total area normalisation (\code{TArea ...
R/pqn.R#L17 #' If binning is applied, the function u ...
R/pqn.R#L19 #' @return A matrix with the same dimens ...
R/pqn.R#L22 #' Dieterle F, Ross A, Schlotterbeck G,  ...
R/pqn.R#L39     if (!all(c("ppm", "width") %in% name ...
R/pqn.R#L40       stop("Argument 'bin' must be a nam ...
R/pqn.R#L66     if (any(is.na(iref) | is.infinite(ir ...
R/pqn.R#L67     if (length(iref) == 1) X1[iref, ] el ...
R/predict_opls.R#L4 #' Generates predictions (scores and out ...
R/predict_opls.R#L6 #' @param opls_model An object of class  ...
R/predict_opls.R#L7 #' @param newdata A numeric matrix or da ...
R/predict_opls.R#L8 #' @param idx_scale Optional integer vec ...
R/predict_opls.R#L12 #'   \item{Y_predicted}{Predicted numeri ...
R/predict_opls.R#L15 #'   \item{t_orth_pca}{Optional: scores  ...
R/predict_opls.R#L19 #' Class predictions are based on the cl ...
R/predict_opls.R#L20 #' If more than one orthogonal component ...
R/predict_opls.R#L23 #' Trygg J. and Wold S. (2002). Orthogon ...
R/predict_opls.R#L24 #' Geladi P. and Kowalski B.R. (1986). P ...
R/predict_opls.R#L44     stop("Only two-class discriminant an ...
R/predict_opls.R#L56     scale_type <- scale_map[match(opls_m ...
R/predict_opls.R#L103     Y_predicted <- levs$Original[apply(a ...
R/RawGenerics.R#L51 #' @param pars A list containing the apo ...
R/RawGenerics.R#L55   if (is.null(pars$fun) || !pars$fun %in ...
R/RawGenerics.R#L56     stop("Invalid apodisation function s ...
R/RawGenerics.R#L62                    if (!"lb" %in% names( ...
R/RawGenerics.R#L68                    if (!"lb" %in% names( ...
R/RawGenerics.R#L73                      stop("expGaus_resyG ...
R/RawGenerics.R#L79                      stop("Gaussian apod ...
R/RawGenerics.R#L94 #' @description Filters experiments base ...
R/RawGenerics.R#L98 #' @param n_max Integer. Maximum number  ...
R/RawGenerics.R#L104   idx <- match(toupper(names(exp_type)), ...
R/RawGenerics.R#L106     stop("No parameter(s) found that mat ...
R/RawGenerics.R#L112       stop("No matching parameter names  ...
R/RawGenerics.R#L114       message(sprintf("Experiment filter ...
R/RawGenerics.R#L134     stop("No files found that match the  ...
R/RawGenerics.R#L146   fnam <- strsplit(ifelse(!(any(is.na(f_ ...
R/RawGenerics.R#L147   # fnam <- strsplit(ifelse(!(is.na(f_li ...
R/RawGenerics.R#L150   uniq_cols <- vapply(seq_len(ncol(fmat_ ...
R/RawGenerics.R#L159     rack_order_ <- ddply(as.data.frame(r ...
R/RawGenerics.R#L162     fnam1 <- vapply(fnam, function(x) x[ ...
R/RawGenerics.R#L165     exp_ <- vapply(fnam, function(x) x[i ...
R/RawGenerics.R#L193 #' @description Parses `acqus` files to  ...
R/RawGenerics.R#L194 #' @param f_list List. Contains paths to ...
R/RawGenerics.R#L195 #' @return A data frame containing extra ...
R/RawGenerics.R#L210     parsed <- strsplit(gsub("^##\\$", "" ...
R/RawGenerics.R#L249 #' @description Verifies that each NMR e ...
R/RawGenerics.R#L254 #' @param verbose Integer. Controls verb ...
R/RawGenerics.R#L258 .check1d_files_fid <- function(datapath, ...
R/RawGenerics.R#L261   f_acqus <- list.files(datapath, patter ...
R/RawGenerics.R#L262   f_fid <- list.files(datapath, pattern  ...
R/RawGenerics.R#L273         message("Incomplete files detect ...
R/RawGenerics.R#L280       message("File system appears to be ...
R/RawGenerics.R#L305   return(list(path = p_intact, exp_no =  ...
R/RcppExports.R#L10 #' Computes X-weight vectors for each re ...
R/RcppExports.R#L13 #' Conecptually similar to Canonical Cor ...
R/RcppExports.R#L18 #' @param eps Threshold for sum of squar ...
R/RcppExports.R#L20 #' @return A matrix (p × r) of PCA score ...
R/RcppExports.R#L22 #' The function first computes weights f ...
R/RcppExports.R#L23 #' forming a weight matrix `W_x`. PCA is ...
R/RcppExports.R#L24 #' and score components are extracted un ...
R/read1d_raw.R#L4 #' Reads Bruker 1D NMR FIDs from directo ...
R/read1d_raw.R#L6 #' @param path Character. Path to the ro ...
R/read1d_raw.R#L7 #' @param exp_type Named list. Filter fo ...
R/read1d_raw.R#L8 #' @param apodisation Named list. Specif ...
R/read1d_raw.R#L9 #' @param zerofil Integer. Zerofilling e ...
R/read1d_raw.R#L10 #' @param return Character. Spectrum typ ...
R/read1d_raw.R#L11 #' @param verbose Integer. Verbosity lev ...
R/read1d_raw.R#L12 #' @param recursive Logical. Whether to  ...
R/read1d_raw.R#L14 #' @param filter Logical. Whether to rem ...
R/read1d_raw.R#L17 #' Reads FID data from Bruker acquisitio ...
R/read1d_raw.R#L18 #' apodisation, zerofilling, FFT, phase  ...
R/read1d_raw.R#L31 #'   \item{meta}{Data.frame with spectro ...
R/read1d_raw.R#L33 #' Existing objects named \code{X}, \cod ...
R/read1d_raw.R#L45                        exp_type = list(e ...
R/read1d_raw.R#L58   f_list <- .check1d_files_fid(path, n_m ...
R/read1d_raw.R#L83   apoFct <- .fidApodisationFct(n = (pars ...
R/read1d_raw.R#L103     if (length(apoFct) != length(fid_cor ...
R/read1d_raw.R#L118     if (abs(min(sp_re[seq_len(length(sp_ ...
R/read1d_raw.R#L123     if (abs(min(sp_re[seq_len(length(sp_ ...
R/read1d_raw.R#L143   idx_keep <- which(apply(do.call(rbind, ...
R/read1d_raw.R#L144   fnam <- vapply(fnam, function(x) paste ...
R/read1d_raw.R#L148   if (verbose > 0) message("Assigning ob ...
R/read1d.R#L9 #' @param exp_type Named list. Filter ex ...
R/read1d.R#L39     warning("`read1d` will be deprecated ...
R/read1d.R#L42   f_list <- .detect1d_procs(path, n_max  ...
R/read1d.R#L50   ppm_ref <- .chemShift(swidth = pars$a_ ...
R/read1d.R#L53     cs_ppm <- .chemShift(swidth = pars$a ...
R/read1d.R#L92 #' Helper function used by `read1d()` to ...
R/read1d.R#L97 #' @return A data frame of extracted acq ...
R/read1d.R#L108     procs_vals <- strsplit(gsub("^##\\$" ...
R/read1d.R#L110     names(d_procs_val) <- paste0("p_", v ...
R/read1d.R#L118     acqus_vals <- strsplit(gsub("^##\\$" ...
R/read1d.R#L120     names(d_acqu_val) <- paste0("a_", va ...
R/read1d.R#L125       as.POSIXct("1970-01-01 00:00:00",  ...
R/read1d.R#L145   # is_num <- vapply(out_df, function(co ...
R/read1d.R#L155 #' Scans the specified directory recursi ...
R/read1d.R#L160 #' @param filter logical. Whether to fil ...
R/read1d.R#L198   pattern_acqus <- paste0("^", datapath, ...
R/read1d.R#L199   pattern_procs <- paste0("^", datapath, ...
R/read1d.R#L200   pattern_1r <- paste0("^", datapath, .P ...
R/read1d.R#L212   if (length(idx_a) != length(id_a) || l ...
R/read1d.R#L224       message("File system seems to be c ...
R/read1d.R#L233     stop("Mismatch in matching file indi ...
R/read1d.R#L242     stop("Lengths of filtered files (acq ...
R/stocsy.R#L4 #' Performs STOCSY analysis on 1D NMR sp ...
R/stocsy.R#L6 #' @param X Numeric matrix or data frame ...
R/stocsy.R#L7 #' @param ppm Numeric vector of chemical ...
R/stocsy.R#L8 #' @param driver Numeric scalar or vecto ...
R/stocsy.R#L12 #' @return An S4 object of class `stocsy ...
R/stocsy.R#L20 #' plotStocsy(stcy_glucose, shift = c(5. ...
R/stocsy.R#L22 #' @importFrom ggplot2 ggplot aes_string ...
R/stocsy.R#L42   if (!is.matrix(X) && !is.data.frame(X) ...
R/stocsy.R#L43   if (!is.numeric(driver) || (!extD && ( ...
R/stocsy.R#L59     csc_lab <- if (extD) "r(ext, X)" els ...
R/stocsy.R#L71       scale_colour_gradientn(colours = m ...
R/stocsy.R#L95 #' @param stoc_mod An object of class `s ...
R/stocsy.R#L96 #' @param shift Numeric vector of length ...
R/stocsy.R#L99 #' @return A `ggplot2` object displaying ...
R/stocsy.R#L108 #' @importFrom ggplot2 ggplot aes_string ...
R/stocsy.R#L113   if (!inherits(stoc_mod, "stocsy1d_meta ...
R/stocsy.R#L114   if (!is.numeric(shift) || length(shift ...
R/stocsy.R#L128   csc_lab <- if (extD) "r(ext, X)" else  ...
R/stocsy.R#L140   g1 <- ggplot(ds, aes(x = !!sym("ppm"), ...
R/stocsy.R#L143     scale_colour_gradientn(colours = mat ...
R/stocsy.R#L152     g1 <- g1 + geom_vline(xintercept = s ...
R/storm.R#L2 #' @param X  Numeric matrix or dataframe ...
R/storm.R#L4 #' @param b int, expected signal width / ...
R/storm.R#L5 #' @param q num, p value threshold for i ...
R/storm.R#L7 #' @param shift num array, min and max c ...
R/storm.R#L8 #' @details The STORM algorithm can be u ...
R/storm.R#L9 #' @references Posma, Joram M., et al. " ...
R/storm.R#L65     index <- order(pval) # re-order base ...
vignettes/MVA.Rmd#L27   message("The 'yourGitHubPackage' packa ...
vignettes/MVA.Rmd#L35 This tutorial illustrates a multivariate ...
vignettes/MVA.Rmd#L39 Proton (^1^H) NMR data are available in  ...
vignettes/MVA.Rmd#L46 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L64 The following variables should be in the ...
vignettes/MVA.Rmd#L66 * *Xn* - preprocessed NMR data matrix wh ...
vignettes/MVA.Rmd#L67 * *ppm*   - chemical shift vector in par ...
vignettes/MVA.Rmd#L68 * *an*    - sample annotation data frame ...
vignettes/MVA.Rmd#L69 * *meta*  - spectrometer metadata, e.g., ...
vignettes/MVA.Rmd#L73 The following plotly-based functions are ...
vignettes/MVA.Rmd#L75 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L82 In `metabom8`, Principal Component Analy ...
vignettes/MVA.Rmd#L84 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L89 The returned object, *pca_model*, is a s ...
vignettes/MVA.Rmd#L97 Unlike generic PCA functions (e.g., `prc ...
vignettes/MVA.Rmd#L99 - Streamlined model visualisation using  ...
vignettes/MVA.Rmd#L105 The `pca()` function in `metabom8` retur ...
vignettes/MVA.Rmd#L107 Each point in the scores plot represents ...
vignettes/MVA.Rmd#L111 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L113 idx<-which(pca_model@t[,1]>200 | pca_mod ...
vignettes/MVA.Rmd#L118 # Plot PCA scores, colour according to c ...
vignettes/MVA.Rmd#L129 Loadings are visualised as line plots re ...
vignettes/MVA.Rmd#L131 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L135 The x-axis shows chemical shift (ppm); t ...
vignettes/MVA.Rmd#L138 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L154 While PCA revealed clustering by treatme ...
vignettes/MVA.Rmd#L159 - one or more orthogonal components capt ...
vignettes/MVA.Rmd#L161 This separation improves model interpret ...
vignettes/MVA.Rmd#L164 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L173 The model summary plot displays configur ...
vignettes/MVA.Rmd#L183 To guide model complexity, `metabom8` au ...
vignettes/MVA.Rmd#L186 To further support model validation, per ...
vignettes/MVA.Rmd#L188 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L193 Use `dmodx()` to assess outliers based o ...
vignettes/MVA.Rmd#L194 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L200 Scores plots summarise group separation. ...
vignettes/MVA.Rmd#L202 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L210 The predictive component is along the x- ...
vignettes/MVA.Rmd#L214 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L215 plotload(opls.model, type="Statistical r ...
vignettes/MVA.Rmd#L219 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L220 plotload(opls.model, type = "backscaled" ...
vignettes/MVA.Rmd#L223 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L230 This reveals that signals at ~7.365 and  ...
vignettes/MVA.Rmd#L235 Once important variables are identified  ...
vignettes/MVA.Rmd#L238 Metabolites often give rise to multiple  ...
vignettes/MVA.Rmd#L240 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L241 # define driver peak (the ppm variable w ...
vignettes/MVA.Rmd#L258 ```{r, fig.show='hold', fig.width = 7.2, ...
vignettes/MVA.Rmd#L259 # define driver peak (the ppm variable w ...
vignettes/MVA.Rmd#L274 Identified peak patterns can be queried  ...
vignettes/MVA.Rmd#L285 ```{r, fig.show='hold', fig.width = 6, f ...
vignettes/MVA.Rmd#L286 cat("> **Note:** This method provides on ...
vignettes/MVA.Rmd#L291 This vignette introduced a chemometric w ...
vignettes/MVA.Rmd#L299 Together, these tools streamline the exp ...
vignettes/PreProc.Rmd#L27   message("The 'yourGitHubPackage' packa ...
vignettes/PreProc.Rmd#L37 This tutorial runs through a typical dat ...
vignettes/PreProc.Rmd#L54 Proton (^1^H) NMR data are available in  ...
vignettes/PreProc.Rmd#L61 The **`read1d_proc()`** function imports ...
vignettes/PreProc.Rmd#L63 * `exp_type`: list of spectrometer param ...
vignettes/PreProc.Rmd#L65 In this tutorial all standard 1D experim ...
vignettes/PreProc.Rmd#L74 By default, the variables X, ppm, and me ...
vignettes/PreProc.Rmd#L79              'Description'=c('Matrix of  ...
vignettes/PreProc.Rmd#L83 datatable(df, rownames = FALSE, options  ...
vignettes/PreProc.Rmd#L88 The rownames of *X* indicate the folder  ...
vignettes/PreProc.Rmd#L95 Plotting functions for visualising NMR s ...
vignettes/PreProc.Rmd#L99 ```{r spec-overlay-single, fig.show='hol ...
vignettes/PreProc.Rmd#L108 From this overview we can see that the s ...
vignettes/PreProc.Rmd#L112 There are different higher-level plottin ...
vignettes/PreProc.Rmd#L116 Plot formatting using colour, text label ...
vignettes/PreProc.Rmd#L118 For illustration purposes, the following ...
vignettes/PreProc.Rmd#L120 ```{r spec-overlay-mlt, fig.show='hold', ...
vignettes/PreProc.Rmd#L132 The plot above shows that two different  ...
vignettes/PreProc.Rmd#L137 Chemical shift calibration refers to a h ...
vignettes/PreProc.Rmd#L139 We can reference the urine spectra using ...
vignettes/PreProc.Rmd#L140 ```{r calibration, fig.show='hold', fig. ...
vignettes/PreProc.Rmd#L148 After calibration of the urine spectra,  ...
vignettes/PreProc.Rmd#L155 For statistical analysis all calibration ...
vignettes/PreProc.Rmd#L157 ```{r filter, fig.show='hold', fig.width ...
vignettes/PreProc.Rmd#L177 In metabolic phenotyping and in any othe ...
vignettes/PreProc.Rmd#L181 ```{r spec-qc-I, fig.show='hold', fig.wi ...
vignettes/PreProc.Rmd#L196 Further downstream analysis requires the ...
vignettes/PreProc.Rmd#L198 The function **`get_idx()`** can be used ...
vignettes/PreProc.Rmd#L200 ```{r excision, fig.show='hold', fig.wid ...
vignettes/PreProc.Rmd#L220 Macromolecules such as proteins produce  ...
vignettes/PreProc.Rmd#L222 ```{r baseline, fig.show='hold', fig.wid ...
vignettes/PreProc.Rmd#L232 The black line is the baseline corrected ...
vignettes/PreProc.Rmd#L238 Depending on the sample type, spectra ma ...
vignettes/PreProc.Rmd#L240 There are several normalisation methods  ...
vignettes/PreProc.Rmd#L242 The function **`pqn()`** requires at lea ...
vignettes/PreProc.Rmd#L244 ```{r normalisation, fig.show='hold', fi ...
vignettes/PreProc.Rmd#L253 The final step in this preprocessing tut ...
vignettes/PreProc.Rmd#L255 ```{r visual-check, fig.show='hold', fig ...
vignettes/PreProc.Rmd#L265 1D NMR spectra were imported, quality ch ...
vignettes/PreProc.Rmd#L267 The pre-processed spectra can now be sta ...
Consider multiples of 4 spaces for line indents; 1749 lines (27%) are not.
First few lines:
R/alignSegment.R#L32   if (!is.matrix(seg) || nrow(seg) < 2)  ...
R/alignSegment.R#L34   if (med) { ...
R/alignSegment.R#L37   } ...
R/alignSegment.R#L39   if (norm) { ...
R/alignSegment.R#L41   } ...
R/alignSegment.R#L43   out <- vapply(seq_len(nrow(seg)), func ...
R/alignSegment.R#L50       if (xlag > 0) { ...
R/alignSegment.R#L52       } else if (xlag < 0) { ...
R/alignSegment.R#L55       } ...
R/alignSegment.R#L58   }, FUN.VALUE = numeric(ncol(seg))) ...
R/alignSegment.R#L60   out <- t(out) ...
R/alignSegment.R#L61   if (med) out <- out[-1, , drop = FALSE ...
R/alignSegment.R#L62   return(out) ...
R/AllClasses.R#L31   type = "character", ...
R/AllClasses.R#L32   t_pred = "matrix", ...
R/AllClasses.R#L33   p_pred = "matrix", ...
R/AllClasses.R#L34   w_pred = "matrix", ...
R/AllClasses.R#L35   betas_pred = "numeric", ...
R/AllClasses.R#L36   Qpc = "matrix", ...
R/AllClasses.R#L37   t_pred_cv = "matrix", ...
R/AllClasses.R#L38   t_orth_cv = "matrix", ...
R/AllClasses.R#L39   t_orth = "matrix", ...
R/AllClasses.R#L40   p_orth = "matrix", ...
R/AllClasses.R#L41   w_orth = "matrix", ...
R/AllClasses.R#L42   nPC = "numeric", ...
R/AllClasses.R#L43   summary = "data.frame", ...
R/AllClasses.R#L44   X_orth = "matrix", ...
R/AllClasses.R#L45   Y_res = "matrix", ...
R/AllClasses.R#L46   X_res = "matrix", ...
R/AllClasses.R#L47   X_mean = "numeric", ...
R/AllClasses.R#L48   X_sd = "numeric", ...
R/AllClasses.R#L49   Y_mean = "numeric", ...
R/AllClasses.R#L50   Y_sd = "numeric", ...
R/AllClasses.R#L51   Parameters = "list", ...
R/AllClasses.R#L52   X = "matrix", ...
R/AllClasses.R#L53   X_scaled = "matrix", ...
R/AllClasses.R#L54   Y = "list" ...
R/AllClasses.R#L62   object@summary ...
R/AllClasses.R#L146   type = "character", ...
R/AllClasses.R#L147   t_pred = "matrix", ...
R/AllClasses.R#L148   p_pred = "matrix", ...
R/AllClasses.R#L149   w_pred = "matrix", ...
R/AllClasses.R#L150   betas_pred = "numeric", ...
R/AllClasses.R#L151   Qpc = "matrix", ...
R/AllClasses.R#L152   t_pred_cv = "matrix", ...
R/AllClasses.R#L153   nPC = "numeric", ...
R/AllClasses.R#L154   summary = "data.frame", ...
R/AllClasses.R#L155   Y_res = "matrix", ...
R/AllClasses.R#L156   X_res = "matrix", ...
R/AllClasses.R#L157   X_mean = "numeric", ...
R/AllClasses.R#L158   X_sd = "numeric", ...
R/AllClasses.R#L159   Y_mean = "numeric", ...
R/AllClasses.R#L160   Y_sd = "numeric", ...
R/AllClasses.R#L161   Parameters = "list", ...
R/AllClasses.R#L162   X = "matrix", ...
R/AllClasses.R#L163   X_scaled = "matrix", ...
R/AllClasses.R#L164   Y = "list" ...
R/AllClasses.R#L179   version = "character", ...
R/AllClasses.R#L180   X = "matrix", ...
R/AllClasses.R#L181   ppm = "vector", ...
R/AllClasses.R#L182   driver = "numeric", ...
R/AllClasses.R#L183   r = "vector", ...
R/AllClasses.R#L184   cov = "vector" ...
R/AllClasses.R#L201   type = "character", ...
R/AllClasses.R#L202   t = "matrix", ...
R/AllClasses.R#L203   p = "matrix", ...
R/AllClasses.R#L204   nPC = "numeric", ...
R/AllClasses.R#L205   X_mean = "numeric", ...
R/AllClasses.R#L206   X_sd = "numeric", ...
R/AllClasses.R#L207   Parameters = "list", ...
R/AllClasses.R#L208   X = "matrix" ...
R/AllClasses.R#L216   object@type ...
R/AllClasses.R#L221   object@t ...
R/AllGenerics.R#L9   if (!inherits(Y, c("matrix", "data.fra ...
R/AllGenerics.R#L11   } else { ...
R/AllGenerics.R#L13   } ...
R/AllGenerics.R#L15   if (anyNA(Y) || any(is.nan(Y)) || any( ...
R/AllGenerics.R#L17   } ...
R/AllGenerics.R#L19   if (is.numeric(Y)) { ...
R/AllGenerics.R#L24   } else { ...
R/AllGenerics.R#L31       stop("Input Y has only a single le ...
R/AllGenerics.R#L34   } ...
R/AllGenerics.R#L36   if (ncol(Y) > 1) { ...
R/AllGenerics.R#L38   } ...
R/AllGenerics.R#L40   return(c(Y_out, type)) ...
R/AllGenerics.R#L51   if (!is.matrix(X) || !is.numeric(X)) { ...
R/AllGenerics.R#L53   } ...
R/AllGenerics.R#L55   if (any(is.na(X) | is.nan(X) | is.infi ...
R/AllGenerics.R#L57   } ...
R/AllGenerics.R#L59   return(invisible(NULL)) ...
R/AllGenerics.R#L77   if (nrow(X) != nrow(Y)) { ...
R/AllGenerics.R#L79   } ...
R/AllGenerics.R#L80   if (ncol(X) <= ncol(Y)) { ...
R/AllGenerics.R#L82   } ...
R/AllGenerics.R#L83   invisible(NULL) ...
R/AllGenerics.R#L105   type <- strsplit(type, '-')[[1]][1] ...
R/AllGenerics.R#L107   if (type == "R") { ...
R/AllGenerics.R#L109   } else { ...
R/AllGenerics.R#L111   } ...
R/AllGenerics.R#L113   nc <- length(cv_est) ...
R/AllGenerics.R#L114   if (nc == pc_max) ...
R/AllGenerics.R#L117   switch(type, ...
R/AllGenerics.R#L118          R = { ...
R/AllGenerics.R#L119            if (any(is.na(cv_est))) { ...
R/AllGenerics.R#L120              stop("Something went wrong: ...
R/AllGenerics.R#L121            } ...
R/AllGenerics.R#L122            if (nc > 1 && (diff(cv_est[(n ...
R/AllGenerics.R#L123          }, ...
R/AllGenerics.R#L124          DA = { ...
R/AllGenerics.R#L125            if (any(is.na(cv_est))) { ...
R/AllGenerics.R#L126              stop("Something went wrong: ...
R/AllGenerics.R#L127            } ...
R/AllGenerics.R#L128            if (nc > 1 && (diff(cv_est[(n ...
R/AllGenerics.R#L129          }) ...
R/AllGenerics.R#L131   return(FALSE) ...
R/AllGenerics.R#L151   n <- nrow(Y) ...
R/AllGenerics.R#L153   if (!is.numeric(k) || is.na(k) || is.i ...
R/AllGenerics.R#L156   } ...
R/AllGenerics.R#L158   if (k != n && n / k < 2) { ...
R/AllGenerics.R#L160   } ...
R/AllGenerics.R#L162   sets <- sample(rep_len(seq_len(k), nro ...
R/AllGenerics.R#L163   sets_list <- lapply(seq_len(k), functi ...
R/AllGenerics.R#L165   }) ...
R/AllGenerics.R#L167   return(sets_list) ...
R/AllGenerics.R#L194   if (!is.list(stratified) || length(str ...
R/AllGenerics.R#L196   } ...
R/AllGenerics.R#L198   Y <- stratified[[2]] ...
R/AllGenerics.R#L199   if (anyNA(Y)) { ...
R/AllGenerics.R#L201   } ...
R/AllGenerics.R#L204   if (anyNA(Y)) { ...
R/AllGenerics.R#L206   } ...
R/AllGenerics.R#L208   if (grepl('R', stratified[[1]])) { ...
R/AllGenerics.R#L212       warning("Insufficient variability  ...
R/AllGenerics.R#L213       return(NULL) ...
R/AllGenerics.R#L216   } else { ...
R/AllGenerics.R#L218   } ...
R/AllGenerics.R#L220   ct <- table(Y) ...
R/AllGenerics.R#L221   if (min(ct) / max(ct) < 0.1) { ...
R/AllGenerics.R#L224   } ...
R/AllGenerics.R#L226   levs <- names(ct) ...
R/AllGenerics.R#L227   if (min(ct) <= k || min(ct) / k < 2 || ...
R/AllGenerics.R#L230   } ...
R/AllGenerics.R#L232   nobs <- floor(min(ct) / k) ...
R/AllGenerics.R#L233   if (nobs == 0) stop("Too few observati ...
R/AllGenerics.R#L235   set_lev <- lapply(levs, function(x, ks ...
R/AllGenerics.R#L240   }) ...
R/AllGenerics.R#L242   idc <- unlist(set_lev) ...
R/AllGenerics.R#L243   sets_list <- lapply(seq_len(k), functi ...
R/AllGenerics.R#L246   }) ...
R/AllGenerics.R#L248   return(sets_list) ...
R/AllGenerics.R#L262   k <- ceiling(k) ...
R/AllGenerics.R#L263   # # Check input: k must be a positive  ...
R/AllGenerics.R#L264   # if (!is.integer(k)) { ...
R/AllGenerics.R#L265   #   k <- ceiling(k) ...
R/AllGenerics.R#L266   #   warning(sprintf("The 'k' parameter ...
R/AllGenerics.R#L267   # } ...
R/AllGenerics.R#L269   if (k <= 0 || k > 1e6 || is.na(k) || i ...
R/AllGenerics.R#L271   } ...
R/AllGenerics.R#L273   # Check split parameter ...
R/AllGenerics.R#L274   if (split <= 0 || split >= 1 || is.na( ...
R/AllGenerics.R#L276   } ...
R/AllGenerics.R#L278   if (split > 0.9 || split < 0.3) { ...
R/AllGenerics.R#L280   } ...
R/AllGenerics.R#L282   n <- nrow(Y) ...
R/AllGenerics.R#L283   n_train <- floor(n * split) ...
R/AllGenerics.R#L284   if (n_train < 1) { ...
R/AllGenerics.R#L286   } ...
R/AllGenerics.R#L288   sets_list <- lapply(seq_len(k), functi ...
R/AllGenerics.R#L290   }) ...
R/AllGenerics.R#L292   return(sets_list) ...
R/AllGenerics.R#L311   k <- ceiling(k) ...
R/AllGenerics.R#L312   # # Validate k ...
R/AllGenerics.R#L313   # if (!is.integer(k)) { ...
R/AllGenerics.R#L314   #   k <- ceiling(k) ...
R/AllGenerics.R#L315   #   warning(sprintf("The k-fold parame ...
R/AllGenerics.R#L316   # } ...
R/AllGenerics.R#L317   if (k <= 2 || k > 1e6 || is.na(k) || i ...
R/AllGenerics.R#L319   } ...
R/AllGenerics.R#L321   # Validate split ...
R/AllGenerics.R#L322   if (split <= 0 || split >= 1 || is.na( ...
R/AllGenerics.R#L324   } ...
R/AllGenerics.R#L325   if (split < 0.3 || split > 0.9) { ...
R/AllGenerics.R#L327   } ...
R/AllGenerics.R#L329   # Prepare outcome Y ...
R/AllGenerics.R#L330   type <- stratified[[1]] ...
R/AllGenerics.R#L331   Ymat <- stratified[[2]] ...
R/AllGenerics.R#L332   probs <- stratified[[3]] ...
R/AllGenerics.R#L334   if (grepl("R", type)) { ...
R/AllGenerics.R#L337       stop("Y has insufficient variabili ...
R/AllGenerics.R#L340   } else { ...
R/AllGenerics.R#L342   } ...
R/AllGenerics.R#L344   tabY <- table(Y) ...
R/AllGenerics.R#L346   # Check class imbalance ...
R/AllGenerics.R#L347   if (min(tabY) / max(tabY) < 0.1) { ...
R/AllGenerics.R#L349   } ...
R/AllGenerics.R#L351   # Determine number of training samples ...
R/AllGenerics.R#L352   n_obs <- floor(min(tabY) * split) ...
R/AllGenerics.R#L353   if (n_obs == 0) { ...
R/AllGenerics.R#L355   } ...
R/AllGenerics.R#L357   # Generate training sets ...
R/AllGenerics.R#L358   sets_list <- lapply(seq_len(k), functi ...
R/AllGenerics.R#L360       sample(which(Y == class), size = n ...
R/AllGenerics.R#L363   }) ...
R/AllGenerics.R#L365   return(sets_list) ...
R/AllGenerics.R#L388   valid_methods <- c("k-fold", "k-fold_s ...
R/AllGenerics.R#L389   if (!method %in% valid_methods) { ...
R/AllGenerics.R#L391   } ...
R/AllGenerics.R#L393   Y <- as.matrix(Y) ...
R/AllGenerics.R#L394   if (ncol(Y) > 1) { ...
R/AllGenerics.R#L396   } ...
R/AllGenerics.R#L398   valid_methods <- c("k-fold", "k-fold_s ...
R/AllGenerics.R#L399   if (!method %in% valid_methods) { ...
R/AllGenerics.R#L401   } ...
R/AllGenerics.R#L403   if (k %% 1 == 0) { ...
R/AllGenerics.R#L405   } ...
R/AllGenerics.R#L407   if (grepl("MC", method) && (split <= 0 ...
R/AllGenerics.R#L409   } ...
R/AllGenerics.R#L411   k <- as.integer(k) ...
R/AllGenerics.R#L412   if (k < 2) stop("Number of folds or it ...
R/AllGenerics.R#L415   sets_list <- switch(method, ...
R/AllGenerics.R#L416                       `k-fold_stratified ...
R/AllGenerics.R#L417                       `k-fold` = .kFold( ...
R/AllGenerics.R#L418                       MC = .mc(k, Y, spl ...
R/AllGenerics.R#L419                       MC_balanced = .mcB ...
R/AllGenerics.R#L420   ) ...
R/AllGenerics.R#L422   if (is.null(sets_list)) { ...
R/AllGenerics.R#L424   } ...
R/AllGenerics.R#L426   return(sets_list) ...
R/AllGenerics.R#L447   if (!is.numeric(Y)) { ...
R/AllGenerics.R#L453       # Binary classification: encode as ...
R/AllGenerics.R#L454       Y_num <- as.numeric(Y_factor) ...
R/AllGenerics.R#L455       mapping <- data.frame(Level = Y_le ...
R/AllGenerics.R#L458       return(list(matrix(Y_num, ncol = 1 ...
R/AllGenerics.R#L461       # Multiclass classification: dummy ...
R/AllGenerics.R#L462       Y_mat <- vapply( ...
R/AllGenerics.R#L466       ) ...
R/AllGenerics.R#L467       colnames(Y_mat) <- Y_levels ...
R/AllGenerics.R#L469       mapping <- data.frame(Level = Y_le ...
R/AllGenerics.R#L473       return(list(Y_mat, mapping)) ...
R/AllGenerics.R#L476   } else { ...
R/AllGenerics.R#L479       stop("Only single-column numeric i ...
R/AllGenerics.R#L483   } ...
R/AllGenerics.R#L515   if (nc == 1) { ...
R/AllGenerics.R#L517       list( ...
R/AllGenerics.R#L523       ) ...
R/AllGenerics.R#L525   } else { ...
R/AllGenerics.R#L527       fold$t_xo <- cbind(fold$t_xo, NA_r ...
R/AllGenerics.R#L528       fold$t_xp <- cbind(fold$t_xp, NA_r ...
R/AllGenerics.R#L529       fold ...
R/AllGenerics.R#L531   } ...
R/AllGenerics.R#L533   mod.cv <- lapply(seq_along(cv.set), fu ...
R/AllGenerics.R#L556   }) ...
R/AllGenerics.R#L558   return(mod.cv) ...
R/AllGenerics.R#L590   ### feat t_xo -> can be more than sing ...
R/AllGenerics.R#L592   if (!feat %in% names(cv_obj[[1]])) sto ...
R/AllGenerics.R#L593   oc_ind <- (feat == 't_xo') && (ncol(cv ...
R/AllGenerics.R#L595   inter <- lapply(cv_obj, `[[`, feat) ...
R/AllGenerics.R#L597   if (grepl("MC", cv_type) || (grepl("k- ...
R/AllGenerics.R#L600       valid <- which(!is.na(x)) ...
R/AllGenerics.R#L601       mean_val <- sum(x, na.rm = TRUE) / ...
R/AllGenerics.R#L602       return(mean_val) ...
R/AllGenerics.R#L621   } else { ...
R/AllGenerics.R#L623       # no mean required ...
R/AllGenerics.R#L624       f_mat <- abind::abind(inter, along ...
R/AllGenerics.R#L625       fout <- apply(f_mat, c(1, 2), func ...
R/AllGenerics.R#L628       }) ...
R/AllGenerics.R#L630   } ...
R/AllGenerics.R#L632   return(fout) ...
R/AllGenerics.R#L636   if (!feat %in% names(cv_obj[[1]])) sto ...
R/AllGenerics.R#L637   inter <- lapply(cv_obj, `[[`, feat) ...
R/AllGenerics.R#L638   if (grepl("MC", cv_type) || (grepl("k- ...
R/AllGenerics.R#L640       # cbind(inter) ...
R/AllGenerics.R#L641       f_mat <- abind::abind(inter, along ...
R/AllGenerics.R#L642       fout <- apply(f_mat, c(1, 2), func ...
R/AllGenerics.R#L646       }) ...
R/AllGenerics.R#L648       f_mat <- do.call(cbind, inter) ...
R/AllGenerics.R#L649       fout <- apply(f_mat, 1, function(x ...
R/AllGenerics.R#L653       }) ...
R/AllGenerics.R#L655   } else { ...
R/AllGenerics.R#L657       f_mat <- abind::abind(inter, along ...
R/AllGenerics.R#L658       fout <- apply(f_mat, c(1, 2), func ...
R/AllGenerics.R#L661       }) ...
R/AllGenerics.R#L663   } ...
R/AllGenerics.R#L665   return(fout) ...
R/AllGenerics.R#L688   if (!is.numeric(Y)) stop("Y must be nu ...
R/AllGenerics.R#L689   if (!is.numeric(Yhat)) stop("Yhat must ...
R/AllGenerics.R#L691   if (is.null(dim(Y))) { ...
R/AllGenerics.R#L694   } else { ...
R/AllGenerics.R#L697   } ...
R/AllGenerics.R#L699   if (!is.null(ytss) && !is.numeric(ytss ...
R/AllGenerics.R#L701   press <- sum((Y - Yhat)^2, na.rm = TRU ...
R/AllGenerics.R#L703   if (is.null(ytss)) { ...
R/AllGenerics.R#L705   } ...
R/AllGenerics.R#L707   return(1 - (press / ytss)) ...
R/AllGenerics.R#L738   type <- strsplit(type, '-')[[1]][1] ...
R/AllGenerics.R#L740   # Construct summary table ...
R/AllGenerics.R#L741   model_summary <- switch(type, ...
R/AllGenerics.R#L742                           'DA' = data.fr ...
R/AllGenerics.R#L748                           ), ...
R/AllGenerics.R#L749                           'R' = data.fra ...
R/AllGenerics.R#L755                           ) ...
R/AllGenerics.R#L756   ) ...
R/AllGenerics.R#L758   model_summary$PC_orth <- seq_len(nrow( ...
R/AllGenerics.R#L760   mm <- reshape2::melt(model_summary, id ...
R/AllGenerics.R#L761   mm$PC <- paste0(mm$PC_pred, '+', mm$PC ...
R/AllGenerics.R#L762   mm$alph <- 1 ...
R/AllGenerics.R#L763   mm$alph[mm$PC_orth == max(mm$PC_orth)] ...
R/AllGenerics.R#L765   # Avoid very negative bars pulling dow ...
R/AllGenerics.R#L766   idx <- which(mm$value < (-0.015) & mm$ ...
R/AllGenerics.R#L767   mm$value[idx] <- -0.01 ...
R/AllGenerics.R#L769   mm[is.na(mm$value),"value"] <- 0 # r2x ...
R/AllGenerics.R#L771   if(grepl('k-fold', cv$method)){ ...
R/AllGenerics.R#L773   } else{ ...
R/AllGenerics.R#L775   } ...
R/AllGenerics.R#L777   g <- ggplot2::ggplot(mm, ggplot2::aes( ...
R/AllGenerics.R#L780       values = c(R2X = "#1b9e77", R2Y =  ...
R/AllGenerics.R#L781       labels = c( ...
R/AllGenerics.R#L787       ), ...
R/AllGenerics.R#L788       name = "" ...
R/AllGenerics.R#L792       x = "Predictive + Orthogonal Compo ...
R/AllGenerics.R#L793       y = "", ...
R/AllGenerics.R#L794       title = paste("O-PLS-", type, "  - ...
R/AllGenerics.R#L795       caption = cv_text ...
R/AllGenerics.R#L799       legend.text = element_text(), ...
R/AllGenerics.R#L800       panel.grid.major.x = element_blank ...
R/AllGenerics.R#L801       panel.grid.major.y = element_line( ...
R/AllGenerics.R#L802       panel.grid.minor = element_blank() ...
R/AllGenerics.R#L803       panel.border = element_blank(), ...
R/AllGenerics.R#L804       axis.line.x = element_line(color = ...
R/AllGenerics.R#L805       axis.line.y = element_blank(), ...
R/AllGenerics.R#L806       axis.ticks = element_blank(), ...
R/AllGenerics.R#L807       legend.key = element_rect(colour = ...
R/AllGenerics.R#L808       text = element_text(family = "Helv ...
R/AllGenerics.R#L811   # Set y-axis limits ...
R/AllGenerics.R#L812   if (any(mm$value < 0, na.rm = TRUE)) { ...
R/AllGenerics.R#L814   } else { ...
R/AllGenerics.R#L816   } ...
R/AllGenerics.R#L818   return(list(model_summary, g)) ...
R/AllGenerics.R#L849   type <- strsplit(type, '-')[[1]][1] ...
R/AllGenerics.R#L851   # Construct summary table ...
R/AllGenerics.R#L852   model_summary <- switch(type, ...
R/AllGenerics.R#L853                           'DA' = data.fr ...
R/AllGenerics.R#L859                           ), ...
R/AllGenerics.R#L860                           'R' = data.fra ...
R/AllGenerics.R#L866                           ) ...
R/AllGenerics.R#L867   ) ...
R/AllGenerics.R#L869   # Reshape for plotting ...
R/AllGenerics.R#L870   mm <- reshape2::melt(model_summary, id ...
R/AllGenerics.R#L871   mm$PC <- paste0('PC', mm$PC_pred) ...
R/AllGenerics.R#L872   mm$alph <- 1 ...
R/AllGenerics.R#L873   mm$alph[mm$PC_orth == max(mm$PC_orth)] ...
R/AllGenerics.R#L875   # Avoid very negative bars pulling dow ...
R/AllGenerics.R#L876   idx <- which(mm$value < (-0.015) & mm$ ...
R/AllGenerics.R#L877   mm$value[idx] <- -0.01 ...
R/AllGenerics.R#L879   if(grepl('k-fold', cv$method)){ ...
R/AllGenerics.R#L881   } else{ ...
R/AllGenerics.R#L883   } ...
R/AllGenerics.R#L885   g <- ggplot2::ggplot(mm, ggplot2::aes( ...
R/AllGenerics.R#L888       values = c(R2X = "lightgreen", R2Y ...
R/AllGenerics.R#L889       labels = c( ...
R/AllGenerics.R#L895       ), ...
R/AllGenerics.R#L896       name = "" ...
R/AllGenerics.R#L900       x = "Component(s)", ...
R/AllGenerics.R#L901       y = "", ...
R/AllGenerics.R#L902       title = paste("PLS-", type, "  - C ...
R/AllGenerics.R#L903       caption =  cv_text ...
R/AllGenerics.R#L907       legend.text = element_text(), ...
R/AllGenerics.R#L908       panel.grid.major.x = element_blank ...
R/AllGenerics.R#L909       panel.grid.major.y = element_line( ...
R/AllGenerics.R#L910       panel.grid.minor = element_blank() ...
R/AllGenerics.R#L911       panel.border = element_blank(), ...
R/AllGenerics.R#L912       axis.line.x = element_line(color = ...
R/AllGenerics.R#L913       axis.line.y = element_blank(), ...
R/AllGenerics.R#L914       axis.ticks = element_blank(), ...
R/AllGenerics.R#L915       legend.key = element_rect(colour = ...
R/AllGenerics.R#L916       text = element_text(family = "Helv ...
R/AllGenerics.R#L919   # Set y-axis limits ...
R/AllGenerics.R#L920   if (any(mm$value < 0, na.rm = TRUE)) { ...
R/AllGenerics.R#L922   } else { ...
R/AllGenerics.R#L924   } ...
R/AllGenerics.R#L926   return(list(model_summary, g)) ...
R/AllGenerics.R#L950   if (any(is.na(ppm) | is.infinite(ppm)) ...
R/AllGenerics.R#L952   if (ncol(X) != length(ppm)) return(FAL ...
R/AllGenerics.R#L954   return(TRUE) ...
R/AllGenerics.R#L971   if (is.null(ncol(X))) return(t(X)) ...
R/AllGenerics.R#L972   return(X) ...
R/AllGenerics.R#L997   range <- sort(range, decreasing = TRUE ...
R/AllGenerics.R#L998   which(ppm <= range[1] & ppm >= range[2 ...
R/AllGenerics.R#L1004   warning("`get.idx` is deprecated and w ...
R/AllGenerics.R#L1005   get_idx(range, ppm) ...
R/AllGenerics.R#L1031   ra <- sort(ra) ...
R/AllGenerics.R#L1032   (ra[2] - ra[1]) * (x - min(x)) / (max( ...
R/AllGenerics.R#L1061   stopifnot(is.numeric(x)) ...
R/AllGenerics.R#L1062   r <- range(x, na.rm = na.rm) ...
R/AllGenerics.R#L1063   d <- r[2] - r[1] ...
R/AllGenerics.R#L1064   if (is.na(d) || d == 0) { ...
R/AllGenerics.R#L1066   } ...
R/AllGenerics.R#L1067   (x - r[1]) / d ...
R/AllGenerics.R#L1109   idx <- get_idx(shift, ppm) ...
R/AllGenerics.R#L1110   asign <- sign(ppm[2] - ppm[1])  # dire ...
R/AllGenerics.R#L1112   fwhm <- apply(X[, idx, drop = FALSE],  ...
R/AllGenerics.R#L1115       x <- x + abs(min(x, na.rm = TRUE)) ...
R/AllGenerics.R#L1116       baseline <- 0 ...
R/AllGenerics.R#L1118       baseline <- min(x, na.rm = TRUE) ...
R/AllGenerics.R#L1130       return(NA_real_) ...
R/AllGenerics.R#L1135   }) ...
R/AllGenerics.R#L1137   return(fwhm * sf) ...
R/AllGenerics.R#L1175   idx <- get_idx(where, ppm) ...
R/AllGenerics.R#L1177   if (length(idx) < 50) { ...
R/AllGenerics.R#L1179   } ...
R/AllGenerics.R#L1181   noise <- apply(X[, idx, drop = FALSE], ...
R/AllGenerics.R#L1184   }) ...
R/AllGenerics.R#L1186   return(noise) ...
R/AllGenerics.R#L1212   an <- .check_an_viz(an, obj) ...
R/AllGenerics.R#L1213   idx_orth <- grepl("o", pc) ...
R/AllGenerics.R#L1214   pc1 <- if (any(idx_orth)) as.numeric(g ...
R/AllGenerics.R#L1216   if (any(is.na(pc1) | is.infinite(pc1)) ...
R/AllGenerics.R#L1218   } ...
R/AllGenerics.R#L1220   if (any(idx_orth) && any(pc1[idx_orth] ...
R/AllGenerics.R#L1222   } ...
R/AllGenerics.R#L1224   com <- list() ...
R/AllGenerics.R#L1225   cls <- class(obj)[1] ...
R/AllGenerics.R#L1227   extract_matrix <- function(source, com ...
R/AllGenerics.R#L1230   } ...
R/AllGenerics.R#L1232   if (type == "p") { ...
R/AllGenerics.R#L1234       com[[i]] <- if (cls == "PCA_metabo ...
R/AllGenerics.R#L1236       } else if (cls == "PLS_metabom8")  ...
R/AllGenerics.R#L1238       } else { ...
R/AllGenerics.R#L1240       } ...
R/AllGenerics.R#L1242   } else if (type == "t") { ...
R/AllGenerics.R#L1244       com[[i]] <- if (cls == "PCA_metabo ...
R/AllGenerics.R#L1246       } else if (cls == "PLS_metabom8")  ...
R/AllGenerics.R#L1248       } else { ...
R/AllGenerics.R#L1250       } ...
R/AllGenerics.R#L1252   } else if (type == "t_cv") { ...
R/AllGenerics.R#L1256       com[[i]] <- if (grepl("o", pc[i])) ...
R/AllGenerics.R#L1259   } ...
R/AllGenerics.R#L1261   melted <- as.data.frame(com) ...
R/AllGenerics.R#L1262   colnames(melted) <- paste0("pc_", pc) ...
R/AllGenerics.R#L1264   # Process annotations ...
R/AllGenerics.R#L1265   an_full <- lapply(an, function(x, le_m ...
R/AllGenerics.R#L1270   }) ...
R/AllGenerics.R#L1272   an_df <- as.data.frame(an_full) ...
R/AllGenerics.R#L1273   colnames(an_df) <- names(an) ...
R/AllGenerics.R#L1274   melted <- cbind(melted, an_df) ...
R/AllGenerics.R#L1276   return(list(df = melted, an_le = ncol( ...
R/AllGenerics.R#L1294   if (is.na(pc) || is.infinite(pc) || le ...
R/AllGenerics.R#L1296   } ...
R/AllGenerics.R#L1298   mod_class <- class(mod)[1] ...
R/AllGenerics.R#L1300   if (mod_class == "PCA_metabom8") { ...
R/AllGenerics.R#L1303   } ...
R/AllGenerics.R#L1305   if (mod_class == "OPLS_metabom8") { ...
R/AllGenerics.R#L1308       pc1 <- as.numeric(gsub("o", "", pc ...
R/AllGenerics.R#L1309       if (any(is.na(pc1)) || any(is.infi ...
R/AllGenerics.R#L1311       } ...
R/AllGenerics.R#L1312       if (any(pc1 > nrow(mod@p_orth))) { ...
R/AllGenerics.R#L1314       } ...
R/AllGenerics.R#L1316       if (!is.numeric(as.numeric(pc))) { ...
R/AllGenerics.R#L1318       } ...
R/AllGenerics.R#L1319       if (length(mod@p_pred) == 0) { ...
R/AllGenerics.R#L1321       } ...
R/AllGenerics.R#L1323   } ...
R/AllGenerics.R#L1352   p_mod <- .viz_df_helper(mod, pc, an =  ...
R/AllGenerics.R#L1354   p_bs <- p_mod$df[, 1] * mod@X_sd       ...
R/AllGenerics.R#L1355   p_abs <- minmax(abs(p_mod$df[, 1]))    ...
R/AllGenerics.R#L1357   df <- data.frame(p_bs = p_bs, p_abs =  ...
R/AllGenerics.R#L1358   df <- df[idx, ] ...
R/AllGenerics.R#L1360   return(df) ...
R/AllGenerics.R#L1391   t_mod <- .viz_df_helper(mod, pc, an =  ...
R/AllGenerics.R#L1392   cc <- cor(t_mod$df[, 1], X)[1, ] ...
R/AllGenerics.R#L1393   cv <- cov(t_mod$df[, 1], X)[1, ] ...
R/AllGenerics.R#L1395   df <- data.frame(cor = abs(cc), cov =  ...
R/AllGenerics.R#L1396   df <- df[idx, ] ...
R/AllGenerics.R#L1398   return(df) ...
R/AllGenerics.R#L1422   if (missing(an)) { ...
R/AllGenerics.R#L1424       an <- list(Y = obj@Y$ori) ...
R/AllGenerics.R#L1426       an <- list("All samples") ...
R/AllGenerics.R#L1428   } ...
R/AllGenerics.R#L1430   if (length(an) > 3) { ...
R/AllGenerics.R#L1432   } ...
R/AllGenerics.R#L1434   # remove NULLs ...
R/AllGenerics.R#L1435   an <- an[!vapply(an, is.null, logical( ...
R/AllGenerics.R#L1437   # assign default names if none exist ...
R/AllGenerics.R#L1438   if (is.null(names(an))) { ...
R/AllGenerics.R#L1440   } ...
R/AllGenerics.R#L1442   # fix duplicated names ...
R/AllGenerics.R#L1443   if (any(duplicated(names(an)))) { ...
R/AllGenerics.R#L1446   } ...
R/AllGenerics.R#L1448   # fix missing names ...
R/AllGenerics.R#L1449   missing_names <- is.na(names(an)) | na ...
R/AllGenerics.R#L1450   if (any(missing_names)) { ...
R/AllGenerics.R#L1452   } ...
R/AllGenerics.R#L1454   return(an) ...
R/AllGenerics.R#L1485   if(is.vector(Y) && is.null(dim(Y))){ ...
R/AllGenerics.R#L1487   } ...
R/AllGenerics.R#L1489   for (i in seq_len(nc_o)) { ...
R/AllGenerics.R#L1491       tt <- .oplsComponentCv(Xs, Y = Y,  ...
R/AllGenerics.R#L1493       tt <- .oplsComponentCv(X = NA, Y = ...
R/AllGenerics.R#L1495   } ...
R/AllGenerics.R#L1497   # Extract CV-based predictions ...
R/AllGenerics.R#L1498   preds_test <- .extMeanCvFeat(cv_obj =  ...
R/AllGenerics.R#L1499   preds_train <- .extMeanCvFeat(tt, feat ...
R/AllGenerics.R#L1501   r2_comp <- q2_comp <- aucs_tr <- aucs_ ...
R/AllGenerics.R#L1502   nc <- 1 ...
R/AllGenerics.R#L1503   tssy <- .tssRcpp(Y) / ncol(Y) ...
R/AllGenerics.R#L1505   cv_method <- strsplit(cv$method, "_")[ ...
R/AllGenerics.R#L1510   # Performance evaluation ...
R/AllGenerics.R#L1511   if (cv_method == 'MC') { ...
R/AllGenerics.R#L1513       if (grepl("mY", type)) { ...
R/AllGenerics.R#L1518       } else { ...
R/AllGenerics.R#L1522       } ...
R/AllGenerics.R#L1523       list(q2 = NA, r2 = NA, aucs_te = a ...
R/AllGenerics.R#L1525       list(q2 = .r2(Y, preds_test, NULL) ...
R/AllGenerics.R#L1527   } else { ...
R/AllGenerics.R#L1529       if (grepl("mY", type)) { ...
R/AllGenerics.R#L1534       } else { ...
R/AllGenerics.R#L1538       } ...
R/AllGenerics.R#L1539       list(q2 = NA, r2 = NA, aucs_te = a ...
R/AllGenerics.R#L1541       list(q2 = .r2(Y, preds_test, NULL) ...
R/AllGenerics.R#L1543   } ...
R/AllGenerics.R#L1545   # if (cv_method == "MC") { ...
R/AllGenerics.R#L1546   #   if (grepl("DA", type)) { ...
R/AllGenerics.R#L1547   #     if (grepl("mY", type)) { ...
R/AllGenerics.R#L1548   #       pred_mean <- preds_test[1, , ] ...
R/AllGenerics.R#L1549   #       colnames(pred_mean) <- colname ...
R/AllGenerics.R#L1550   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1551   #       aucs_te[nc] <- mod$auc ...
R/AllGenerics.R#L1552   #       pred_tr_mean <- preds_train[1, ...
R/AllGenerics.R#L1553   #       colnames(pred_tr_mean) <- coln ...
R/AllGenerics.R#L1554   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1555   #       aucs_tr[nc] <- mod$auc ...
R/AllGenerics.R#L1556   #     } else { ...
R/AllGenerics.R#L1557   #       mod <- roc(response = Y, predi ...
R/AllGenerics.R#L1558   #       aucs_te[nc] <- mod$auc ...
R/AllGenerics.R#L1559   #       mod <- roc(response = Y, predi ...
R/AllGenerics.R#L1560   #       aucs_tr[nc] <- mod$auc ...
R/AllGenerics.R#L1561   #     } ...
R/AllGenerics.R#L1562   #   } else { ...
R/AllGenerics.R#L1563   #     if (grepl("mY", type)) { ...
R/AllGenerics.R#L1564   #       r2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1565   #       q2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1566   #     } else { ...
R/AllGenerics.R#L1567   #       r2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1568   #       q2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1569   #     } ...
R/AllGenerics.R#L1570   #   } ...
R/AllGenerics.R#L1571   # } else if (cv_method == "k-fold") { ...
R/AllGenerics.R#L1572   #   if (grepl("DA", type)) { ...
R/AllGenerics.R#L1573   #     if (grepl("mY", type)) { ...
R/AllGenerics.R#L1574   #       colnames(preds_test) <- colnam ...
R/AllGenerics.R#L1575   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1576   #       aucs_te[nc] <- mod$auc ...
R/AllGenerics.R#L1577   #       preds_te <- preds_train[1, , ] ...
R/AllGenerics.R#L1578   #       colnames(preds_te) <- colnames ...
R/AllGenerics.R#L1579   #       mod <- multiclass.roc(response ...
R/AllGenerics.R#L1580   #       aucs_tr[nc] <- mod$auc ...
R/AllGenerics.R#L1581   #     } else { ...
R/AllGenerics.R#L1582   #       mod <- roc(response = as.vecto ...
R/AllGenerics.R#L1583   #       aucs_te[nc] <- mod$auc ...
R/AllGenerics.R#L1584   #       mod <- roc(response = as.vecto ...
R/AllGenerics.R#L1585   #       aucs_tr[nc] <- mod$auc ...
R/AllGenerics.R#L1586   #     } ...
R/AllGenerics.R#L1587   #   } else { ...
R/AllGenerics.R#L1588   #     if (grepl("mY", type)) { ...
R/AllGenerics.R#L1589   #       r2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1590   #       q2_comp[nc] <- .r2(Y, preds_te ...
R/AllGenerics.R#L1591   #     } else { ...
R/AllGenerics.R#L1592   #       r2_comp[nc] <- .r2(Y, t(t(pred ...
R/AllGenerics.R#L1593   #       q2_comp[nc] <- .r2(Y, as.array ...
R/AllGenerics.R#L1594   # ...
R/AllGenerics.R#L1595   #       # r2_comp[nc] <- .r2(Y, preds_ ...
R/AllGenerics.R#L1596   #       # q2_comp[nc] <- .r2(Y, preds_ ...
R/AllGenerics.R#L1597   #     } ...
R/AllGenerics.R#L1598   #   } ...
R/AllGenerics.R#L1599   # } ...
R/AllGenerics.R#L1601   # return(list(r2_comp = r2_comp, q2_co ...
R/AllGenerics.R#L1617   tryCatch({ ...
R/AllGenerics.R#L1621       FALSE ...
R/AllGenerics.R#L1623       TRUE ...
R/AllGenerics.R#L1625   }, warning = function(w) { ...
R/AllGenerics.R#L1628   }, error = function(e) { ...
R/AllGenerics.R#L1631   }) ...
R/AllViz.R#L32                  base = FALSE, add = FAL ...
R/AllViz.R#L34   if (!is.null(ncol(x))) stop("x must be ...
R/AllViz.R#L35   if (length(x) != length(ppm)) stop("x  ...
R/AllViz.R#L37   idx <- get_idx(shift, ppm) ...
R/AllViz.R#L38   ppm_sub <- ppm[idx] ...
R/AllViz.R#L39   x_sub <- x[idx] ...
R/AllViz.R#L41   if (interactive && !base) { ...
R/AllViz.R#L44       plotly::layout( ...
R/AllViz.R#L47       ) ...
R/AllViz.R#L48   } else { ...
R/AllViz.R#L50       graphics::points(ppm_sub, x_sub, t ...
R/AllViz.R#L52       graphics::plot(ppm_sub, x_sub, typ ...
R/AllViz.R#L53                      xlab = "ppm", ylab  ...
R/AllViz.R#L56   } ...
R/AllViz.R#L88   if (!.check_X_ppm(X, ppm)) { ...
R/AllViz.R#L90   } ...
R/AllViz.R#L92   idx <- get_idx(shift, ppm) ...
R/AllViz.R#L93   ppm_sub <- ppm[idx] ...
R/AllViz.R#L94   X_sub <- X[, idx, drop = FALSE] ...
R/AllViz.R#L96   if (interactive) { ...
R/AllViz.R#L106                          type = "scatter ...
R/AllViz.R#L107                          hovertemplate = ...
R/AllViz.R#L108       plotly::layout( ...
R/AllViz.R#L111       ) ...
R/AllViz.R#L114   } ...
R/AllViz.R#L116   graphics::matplot(ppm_sub, t(X_sub), t ...
R/AllViz.R#L118   invisible(NULL) ...
R/AllViz.R#L159   if (!.check_X_ppm(X, ppm)) { ...
R/AllViz.R#L161   } ...
R/AllViz.R#L163   idx <- get_idx(shift, ppm) ...
R/AllViz.R#L164   specs <- X[, idx, drop = FALSE] ...
R/AllViz.R#L165   colnames(specs) <- paste0("ppm_", idx) ...
R/AllViz.R#L167   if (is.null(names(an))) { ...
R/AllViz.R#L169   } ...
R/AllViz.R#L170   names(an) <- make.names(names(an), uni ...
R/AllViz.R#L172   df <- data.frame(do.call(cbind.data.fr ...
R/AllViz.R#L173   colnames(df)[seq_along(an)] <- names(a ...
R/AllViz.R#L174   df <- reshape2::melt(df, id.vars = c(" ...
R/AllViz.R#L175   df$variable <- ppm[as.numeric(gsub("pp ...
R/AllViz.R#L177   g <- ggplot2::ggplot() + ...
R/AllViz.R#L179                              breaks = se ...
R/AllViz.R#L181   # Add traces based on number of groupi ...
R/AllViz.R#L182   switch(as.character(length(an)), ...
R/AllViz.R#L183          "1" = { ...
R/AllViz.R#L184            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L185                                        a ...
R/AllViz.R#L186          }, ...
R/AllViz.R#L187          "2" = { ...
R/AllViz.R#L188            col_var <- names(an)[2] ...
R/AllViz.R#L189            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L190                                        a ...
R/AllViz.R#L191            if (!is.factor(an[[2]]) && !i ...
R/AllViz.R#L192              g <- g + ggplot2::scale_col ...
R/AllViz.R#L193            } ...
R/AllViz.R#L194          }, ...
R/AllViz.R#L195          "3" = { ...
R/AllViz.R#L196            df[[names(an)[3]]] <- factor( ...
R/AllViz.R#L197            g <- g + ggplot2::geom_line(d ...
R/AllViz.R#L198                                          ...
R/AllViz.R#L199                                        a ...
R/AllViz.R#L200            if (!is.factor(an[[2]]) && !i ...
R/AllViz.R#L201              g <- g + ggplot2::scale_col ...
R/AllViz.R#L202            } ...
R/AllViz.R#L203          }) ...
R/AllViz.R#L205   g <- g + ...
R/AllViz.R#L211       axis.text = element_text(colour =  ...
R/AllViz.R#L212       axis.text.x = element_text(angle = ...
R/AllViz.R#L215   return(g) ...
R/AllViz.R#L258                      type = "Backscaled" ...
R/AllViz.R#L260   if (!inherits(mod, c("OPLS_metabom8",  ...
R/AllViz.R#L262   } ...
R/AllViz.R#L264   X <- mod@X ...
R/AllViz.R#L265   ppm <- as.numeric(colnames(X)) ...
R/AllViz.R#L266   idx <- get_idx(shift, ppm) ...
R/AllViz.R#L267   if (length(idx) < 3) stop("Insufficien ...
R/AllViz.R#L269   type <- if (grepl("st|recon", type, ig ...
R/AllViz.R#L271   } else { ...
R/AllViz.R#L273   } ...
R/AllViz.R#L275   if (type == "Statistical reconstructio ...
R/AllViz.R#L280   } else { ...
R/AllViz.R#L284   } ...
R/AllViz.R#L286   specs <- X[, idx, drop = FALSE] ...
R/AllViz.R#L287   limY <- range(specs) ...
R/AllViz.R#L288   colnames(specs) <- paste0("ppm_", ppm[ ...
R/AllViz.R#L290   an <- .check_an_viz(an, mod) ...
R/AllViz.R#L291   df <- data.frame(ID = seq_len(nrow(spe ...
R/AllViz.R#L292   df <- melt(df, id.vars = c("ID", names ...
R/AllViz.R#L293   df$variable <- as.numeric(gsub("^\\.", ...
R/AllViz.R#L294   colnames(df)[match(names(an)[1], colna ...
R/AllViz.R#L296   # Convert y (loading) to display range ...
R/AllViz.R#L297   cv1 <- (minmax(y) * (limY[2]/3)) + lim ...
R/AllViz.R#L298   if (max(cv1) > limY[2]) { ...
R/AllViz.R#L300   } ...
R/AllViz.R#L302   # Create loadings dataframe ...
R/AllViz.R#L303   fac_lev <- unique(df$facet) ...
R/AllViz.R#L304   df1 <- do.call(rbind, lapply(seq_along ...
R/AllViz.R#L306                ppm = ppm[idx], Intensity ...
R/AllViz.R#L307   })) ...
R/AllViz.R#L309   g <- ggplot() + ...
R/AllViz.R#L311               linewidth = 0.8) + ...
R/AllViz.R#L313               alpha = alp, linewidth = s ...
R/AllViz.R#L322           axis.text.x = element_text(ang ...
R/AllViz.R#L324   g <- g + scale_colour_gradientn(colors ...
R/AllViz.R#L325                                   name = ...
R/AllViz.R#L327                                   } else ...
R/AllViz.R#L329                                   }, ...
R/AllViz.R#L330                                   limits ...
R/AllViz.R#L332   return(g) ...
R/AllViz.R#L376                      type = "Backscaled" ...
R/AllViz.R#L378   if (!inherits(mod, c("OPLS_metabom8",  ...
R/AllViz.R#L380   } ...
R/AllViz.R#L382   type <- if (grepl("st|recon", type, ig ...
R/AllViz.R#L384   } else { ...
R/AllViz.R#L386   } ...
R/AllViz.R#L388   X <- mod@X ...
R/AllViz.R#L389   ppm <- as.numeric(colnames(X)) ...
R/AllViz.R#L390   idx <- get_idx(shift, ppm) ...
R/AllViz.R#L392   if (length(idx) < 3) stop("Insufficien ...
R/AllViz.R#L394   if (type == "Statistical reconstructio ...
R/AllViz.R#L399       geom_line() + ...
R/AllViz.R#L400       scale_x_reverse(breaks = breaks_pr ...
R/AllViz.R#L401       scale_colour_gradientn(colors = ma ...
R/AllViz.R#L402       labs( ...
R/AllViz.R#L407       ) + ...
R/AllViz.R#L408       theme_bw() ...
R/AllViz.R#L409   } else { ...
R/AllViz.R#L413       geom_line() + ...
R/AllViz.R#L414       scale_x_reverse(breaks = breaks_pr ...
R/AllViz.R#L415       scale_colour_gradientn(colors = ma ...
R/AllViz.R#L416       labs( ...
R/AllViz.R#L421       ) + ...
R/AllViz.R#L422       theme_bw() ...
R/AllViz.R#L423   } ...
R/AllViz.R#L425   return(g) ...
R/AllViz.R#L468   if (!inherits(mod, "OPLS_metabom8")) { ...
R/AllViz.R#L470   } ...
R/AllViz.R#L472   E <- mod@X_res ...
R/AllViz.R#L473   N <- nrow(E) ...
R/AllViz.R#L474   K <- ncol(E) ...
R/AllViz.R#L475   A <- ncol(mod@t_pred) ...
R/AllViz.R#L476   A0 <- if (isTRUE(mod@Parameters$center ...
R/AllViz.R#L478   ss_res <- rowSums(E^2) ...
R/AllViz.R#L479   dmodX <- sqrt(ss_res / (K - A)) / sqrt ...
R/AllViz.R#L481   # 95% CI via one-sided t-test ...
R/AllViz.R#L482   tt <- t.test(dmodX, alternative = "les ...
R/AllViz.R#L483   ci95 <- tt$conf.int[2] + 2 * sd(dmodX) ...
R/AllViz.R#L485   df <- data.frame( ...
R/AllViz.R#L489   ) ...
R/AllViz.R#L491   if (plot) { ...
R/AllViz.R#L495       geom_segment(aes(xend = ID, yend = ...
R/AllViz.R#L496       geom_point() + ...
R/AllViz.R#L497       geom_hline(yintercept = ci95, line ...
R/AllViz.R#L498       scale_y_continuous( ...
R/AllViz.R#L502       ) + ...
R/AllViz.R#L503       xlab("Sample index") + ...
R/AllViz.R#L504       theme_bw() + ...
R/AllViz.R#L505       theme( ...
R/AllViz.R#L510       ) + ...
R/AllViz.R#L511       labs(caption = "Dashed line indica ...
R/AllViz.R#L514       g <- g + scale_colour_gradientn(co ...
R/AllViz.R#L518   } ...
R/AllViz.R#L520   return(df) ...
R/binning.R#L23   if (is.null(ppm) && (is.matrix(X) || i ...
R/binning.R#L25   } else { ...
R/binning.R#L27       stop("Non-matching dimensions X ma ...
R/binning.R#L28   } ...
R/binning.R#L30   if (is.vector(X)) { ...
R/binning.R#L32   } ...
R/binning.R#L34   if (!is.null(width) && !is.null(npoint ...
R/binning.R#L36   } ...
R/binning.R#L37   if (is.null(width) && is.null(npoints) ...
R/binning.R#L39   } ...
R/binning.R#L41   if (!is.null(width) && is.null(npoints ...
R/binning.R#L43       stop("Bin width equals or is small ...
R/binning.R#L54       sInter <- approxfun(ppm_fres, x) ...
R/binning.R#L55       s <- sInter(ppmt) ...
R/binning.R#L56       vapply(seq(max(yb)), function(i) { ...
R/binning.R#L59       }, numeric(1)) ...
R/binning.R#L63       iidx <- which(ybin == i) ...
R/binning.R#L64       mean(ppm_new[iidx]) ...
R/binning.R#L70   } ...
R/binning.R#L72   if (!is.null(npoints) && is.null(width ...
R/binning.R#L74       stop("Input variable npoints canno ...
R/binning.R#L82       vapply(seq(max(yb)), function(i) { ...
R/binning.R#L85       }, numeric(1)) ...
R/binning.R#L89       iidx <- which(ybin == i) ...
R/binning.R#L90       mean(ppm[iidx]) ...
R/binning.R#L96   } ...
R/binning.R#L98   return(NULL) ...
R/bline.R#L29   if (any(is.na(X))) { ...
R/bline.R#L32   } ...
R/bline.R#L34   if (as.character(match.call()[[1]]) == ...
R/bline.R#L36   } ...
R/bline.R#L38   X <- .dimX(X) ...
R/bline.R#L39   X.bl <- t(apply(X, 1, function(x) { ...
R/bline.R#L41   })) ...
R/bline.R#L42   return(X.bl) ...
R/calibrate_doub.R#L20   if (type[1] == "glu") { ...
R/calibrate_doub.R#L24   } else if (type[1] == "ala") { ...
R/calibrate_doub.R#L28   } else if (is.numeric(type[1])) { ...
R/calibrate_doub.R#L31   } else { ...
R/calibrate_doub.R#L33   } ...
R/calibrate_doub.R#L35   test <- apply(X[, idx, drop = FALSE],  ...
R/calibrate_doub.R#L38       smoothed <- x - asysm(x, lambda =  ...
R/calibrate_doub.R#L45       return(NULL) ...
R/calibrate_doub.R#L47       return(picks[[1]]) ...
R/calibrate_doub.R#L49   }) ...
R/calibrate_doub.R#L51   if (all(is.null(test))) { ...
R/calibrate_doub.R#L56   s <- lapply(seq_along(test), function( ...
R/calibrate_doub.R#L60       warning('Could not calibrate spect ...
R/calibrate_doub.R#L61       return(NULL) ...
R/calibrate_doub.R#L74       out <- ptab[combs[, valid], ] ...
R/calibrate_doub.R#L76       crit <- apply(combs[, valid], 2, f ...
R/calibrate_doub.R#L80       }) ...
R/calibrate_doub.R#L81       idx_best <- which.max(crit["avg",  ...
R/calibrate_doub.R#L82       out <- ptab[combs[, valid[idx_best ...
R/calibrate_doub.R#L88   }) ...
R/calibrate_doub.R#L90   Xc <- vapply(seq_len(nrow(X)), functio ...
R/calibrate_doub.R#L92       warning(sprintf("Could not calibra ...
R/calibrate_doub.R#L93       return(X[i, ]) ...
R/calibrate_doub.R#L95       shift_fun <- approxfun(x = ppm - ( ...
R/calibrate_doub.R#L96       return(shift_fun(ppm)) ...
R/calibrate_doub.R#L98   }, FUN.VALUE = X[1, ]) ...
R/calibrate_doub.R#L100   return(t(Xc)) ...
R/calibrate.R#L37   if (missing(X) || missing(ppm)) { ...
R/calibrate.R#L39   } ...
R/calibrate.R#L41   if (!is.matrix(X) || !is.numeric(ppm)) ...
R/calibrate.R#L43   } ...
R/calibrate.R#L45   if (!.check_X_ppm(X, ppm)) { ...
R/calibrate.R#L47   } ...
R/calibrate.R#L49   if (is.character(type) && (length(type ...
R/calibrate.R#L51   } ...
R/calibrate.R#L53   if (is.numeric(type) && length(type) ! ...
R/calibrate.R#L55   } ...
R/calibrate.R#L57   if (identical(type, "tsp")) { ...
R/calibrate.R#L59   } ...
R/calibrate.R#L61   rnam <- rownames(X) ...
R/calibrate.R#L62   cnam <- colnames(X) ...
R/calibrate.R#L64   if (is.numeric(type)) { ...
R/calibrate.R#L70       iCorr <- zeroPpm - which.max(X[i,  ...
R/calibrate.R#L71       if (iCorr < 0) { ...
R/calibrate.R#L73       } else if (iCorr > 0) { ...
R/calibrate.R#L75       } else { ...
R/calibrate.R#L77       } ...
R/calibrate.R#L78       x[seq_len(length(ppm))] ...
R/calibrate.R#L80   } else if (type == "glucose") { ...
R/calibrate.R#L82   } else if (type == "alanine") { ...
R/calibrate.R#L84   } else { ...
R/calibrate.R#L86   } ...
R/calibrate.R#L88   rownames(Xc) <- rnam ...
R/calibrate.R#L89   colnames(Xc) <- cnam ...
R/calibrate.R#L90   return(Xc) ...
R/cvanova.R#L49   if (!inherits(smod, "OPLS_metabom8"))  ...
R/cvanova.R#L51   } ...
R/cvanova.R#L53   df_total <- nrow(smod@Y$dummy) - 1 ...
R/cvanova.R#L54   df_reg <- smod@nPC * 2 ...
R/cvanova.R#L55   df_res <- df_total - df_reg ...
R/cvanova.R#L57   lm_null <- lm(smod@Y$dummy[, 1] ~ 1) ...
R/cvanova.R#L58   res_null <- lm_null$residuals ...
R/cvanova.R#L60   lm_model <- lm(smod@Y$dummy[, 1] ~ 1 + ...
R/cvanova.R#L61   res_model <- lm_model$residuals ...
R/cvanova.R#L63   ss_total <- sum(res_null^2) ...
R/cvanova.R#L64   ss_reg <- sum(res_model^2) ...
R/cvanova.R#L65   ss_res <- ss_total - ss_reg ...
R/cvanova.R#L67   ms_total <- ss_total / df_total ...
R/cvanova.R#L68   ms_reg <- ss_reg / df_reg ...
R/cvanova.R#L69   ms_res <- ss_res / df_res ...
R/cvanova.R#L71   F_val <- ms_reg / ms_res ...
R/cvanova.R#L72   p_val <- 1 - pf(F_val, df_reg, df_res) ...
R/cvanova.R#L74   result <- data.frame( ...
R/cvanova.R#L81   ) ...
R/cvanova.R#L83   return(result) ...
R/eruption.R#L51   if (!inherits(mod, "OPLS_metabom8")) { ...
R/eruption.R#L53   } ...
R/eruption.R#L55   if (length(unique(mod@Y$ori)) != 2) { ...
R/eruption.R#L57   } ...
R/eruption.R#L59   if (is.na(pc) || length(pc) != 1 || !i ...
R/eruption.R#L61   } ...
R/eruption.R#L63   if (!is.character(p_adj) || length(p_a ...
R/eruption.R#L65   } ...
R/eruption.R#L67   # Select loading ...
R/eruption.R#L68   if (grepl("o", pc)) { ...
R/eruption.R#L71       stop("Invalid orthogonal component ...
R/eruption.R#L74   } else { ...
R/eruption.R#L76   } ...
R/eruption.R#L78   # Set comparison group ...
R/eruption.R#L79   Y <- mod@Y$ori ...
R/eruption.R#L80   levels_Y <- unique(Y) ...
R/eruption.R#L82   comp_group <- if (invert_es) levels_Y[ ...
R/eruption.R#L83   message("Using ", if (invert_es) level ...
R/eruption.R#L84           " as reference group for Cliff ...
R/eruption.R#L86   # Univariate stats ...
R/eruption.R#L87   idx <- which(Y == comp_group) ...
R/eruption.R#L88   uni_stats <- t(apply(mod@X, 2, functio ...
R/eruption.R#L91   })) ...
R/eruption.R#L93   colnames(uni_stats) <- c("Cd", "pval") ...
R/eruption.R#L94   ddl <- cbind(ddl, uni_stats) ...
R/eruption.R#L95   ddl$p1 <- abs(ddl$p1) ...
R/eruption.R#L97   if (p_adj %in% p.adjust.methods) { ...
R/eruption.R#L100   } else { ...
R/eruption.R#L102   } ...
R/eruption.R#L104   # Plot ...
R/eruption.R#L105   gl2 <- ggplot(ddl, aes(x = !!sym("Cd") ...
R/eruption.R#L112       x = "Cliff's Delta", ...
R/eruption.R#L113       y = paste0("|p_", pc, "|"), ...
R/eruption.R#L114       colour = if (p_adj %in% p.adjust.m ...
R/eruption.R#L116           "| log10( p value ) |" ...
R/eruption.R#L120       panel.grid.minor = element_blank() ...
R/eruption.R#L121       plot.tag = element_text(face = "bo ...
R/eruption.R#L122       legend.position = "top", ...
R/eruption.R#L123       legend.direction = "horizontal" ...
R/eruption.R#L126   ddl$pval_transformed <- NULL ...
R/eruption.R#L127   list(data = ddl, plot = gl2) ...
R/es_cdelta.R#L33   if (!is.numeric(ref) || !is.numeric(co ...
R/es_cdelta.R#L35   } ...
R/es_cdelta.R#L37   ref <- ref[is.finite(ref)] ...
R/es_cdelta.R#L38   comp <- comp[is.finite(comp)] ...
R/es_cdelta.R#L40   if (length(ref) < 5 || length(comp) <  ...
R/es_cdelta.R#L42   } ...
R/es_cdelta.R#L44   # Compare each pair of ref vs comp val ...
R/es_cdelta.R#L45   dominance <- vapply(ref, function(x) { ...
R/es_cdelta.R#L47   }, FUN.VALUE = numeric(2)) ...
R/es_cdelta.R#L49   delta <- (sum(dominance[1, ]) - sum(do ...
R/es_cdelta.R#L50   return(-delta) ...
R/excise1d.R#L35   if (is.vector(X)) X <- t(X) ...
R/excise1d.R#L36   if (ncol(X) != length(ppm)) stop("ppm  ...
R/excise1d.R#L37   if (anyNA(ppm)) stop("ppm contains NA  ...
R/excise1d.R#L39   idx_rm <- c( ...
R/excise1d.R#L44   ) ...
R/excise1d.R#L46   keep_idx <- setdiff(seq_along(ppm), id ...
R/excise1d.R#L47   Xc <- X[, keep_idx, drop = FALSE] ...
R/excise1d.R#L48   ppc <- ppm[keep_idx] ...
R/excise1d.R#L50   return(list(Xc = Xc, ppc = ppc)) ...
R/hotellingsT2.R#L21   if (!is.numeric(x) || !is.numeric(y))  ...
R/hotellingsT2.R#L22   if (length(x) != length(y)) stop("x an ...
R/hotellingsT2.R#L23   if (length(x) < 3) stop("At least 3 ob ...
R/hotellingsT2.R#L25   XY <- cbind(x, y) ...
R/hotellingsT2.R#L26   cov_matrix <- cov(XY, use = "complete. ...
R/hotellingsT2.R#L27   center <- colMeans(XY, na.rm = TRUE) ...
R/hotellingsT2.R#L29   ell <- ellipse::ellipse(cov_matrix, ce ...
R/hotellingsT2.R#L30   colnames(ell) <- c("V1", "V2") ...
R/hotellingsT2.R#L32   return(as.data.frame(ell)) ...
R/normErectic.R#L34   ppm <- as.numeric(colnames(X)) ...
R/normErectic.R#L35   if (is.null(ppm) || any(is.na(ppm)) || ...
R/normErectic.R#L37   idx_scan <- get_idx(c(10, 16), ppm) ...
R/normErectic.R#L38   eretic_peak <- ppm[which.max(X[1, idx_ ...
R/normErectic.R#L40   # Determine ERETIC target window based ...
R/normErectic.R#L41   if (abs(eretic_peak - 12) < abs(eretic ...
R/normErectic.R#L43   } else { ...
R/normErectic.R#L45   } ...
R/normErectic.R#L47   if (integr) { ...
R/normErectic.R#L50   } else { ...
R/normErectic.R#L55   } ...
R/opls_perm.R#L32   if (!inherits(smod, "OPLS_metabom8"))  ...
R/opls_perm.R#L34   } ...
R/opls_perm.R#L36   nc_o <- nrow(smod@summary) - 1 ...
R/opls_perm.R#L37   Xs <- smod@X ...
R/opls_perm.R#L38   Y <- smod@Y$dummy ...
R/opls_perm.R#L39   cv <- list(cv_sets = smod@Parameters$c ...
R/opls_perm.R#L40              k = length(smod@Parameters$ ...
R/opls_perm.R#L41              method = smod@Parameters$cv ...
R/opls_perm.R#L42   type <- smod@type ...
R/opls_perm.R#L44   perms <- lapply(seq_len(n), function(i ...
R/opls_perm.R#L51   }) ...
R/opls_perm.R#L53   # perms <- lapply(seq_len(n), function ...
R/opls_perm.R#L54   #   Y_perm <- matrix(sample(Y[, 1]), n ...
R/opls_perm.R#L55   #   stats <- .permYmod(Xs, Y_perm, cv, ...
R/opls_perm.R#L56   #   list(ind = stats, r = cor(Y[, 1],  ...
R/opls_perm.R#L57   # }) ...
R/opls_perm.R#L59   out_df <- as.data.frame(do.call(rbind, ...
R/opls_perm.R#L63   } ))) ...
R/opls_perm.R#L64   colnames(out_df) <- c("r2_comp", "q2_c ...
R/opls_perm.R#L65   out_df$model <- paste0("perm_", seq_le ...
R/opls_perm.R#L67   idx <- max(which(!is.na(smod@summary$R ...
R/opls_perm.R#L68   model_comp <- smod@summary[idx, ] ...
R/opls_perm.R#L70   if (grepl('DA', smod@type)){ ...
R/opls_perm.R#L72   } else{ ...
R/opls_perm.R#L74   } ...
R/opls_perm.R#L75   out_df <- rbind(out_df, unlist(real_st ...
R/opls_perm.R#L77   # Clean up NA-only columns ...
R/opls_perm.R#L78   idx_rm <- vapply(out_df, function(x) a ...
R/opls_perm.R#L79   out_df <- out_df[, !idx_rm, drop = FAL ...
R/opls_perm.R#L80   out_df$r_abs <- abs(as.numeric(out_df$ ...
R/opls_perm.R#L82   if (plot) { ...
R/opls_perm.R#L86       dd <- reshape2::melt(out_df[,c('au ...
R/opls_perm.R#L89       dd <- reshape2::melt(out_df[, c('r ...
R/opls_perm.R#L103       geom_point() + ...
R/opls_perm.R#L104       theme_bw() + ...
R/opls_perm.R#L105       labs(x = "|r|", y = NULL, colour = ...
R/opls_perm.R#L106            caption = paste0("O-PLS-", ty ...
R/opls_perm.R#L107       scale_y_continuous(limits = c(y_lw ...
R/opls_perm.R#L110   } ...
R/opls_perm.R#L112   return(out_df) ...
R/opls.R#L40                  cv = list(method = "k-f ...
R/opls.R#L41                  maxPCo = 5, plotting =  ...
R/opls.R#L43   inputs <- .prepareInputs(X, Y, center, ...
R/opls.R#L44   type <- inputs$type ...
R/opls.R#L45   is_multi_Y <- grepl('mY', type) ...
R/opls.R#L46   class_memb <- if (is_multi_Y) sub("^Nu ...
R/opls.R#L48   msd_y <- .sdRcpp(inputs$Y) ...
R/opls.R#L49   msd_x <- .sdRcpp(inputs$X) ...
R/opls.R#L50   XcsTot <- .scaleMatRcpp(inputs$X, 0:(n ...
R/opls.R#L51   YcsTot <- .scaleMatRcpp(inputs$Y, 0:(n ...
R/opls.R#L52   tssx <- .tssRcpp(XcsTot) ...
R/opls.R#L53   tssy <- .tssRcpp(YcsTot) / ncol(YcsTot ...
R/opls.R#L55   cv <- .generateCv(inputs$Y, type, cv) ...
R/opls.R#L56   r2_comp <- r2x_comp <- q2_comp <- aucs ...
R/opls.R#L57   nc <- 1 ...
R/opls.R#L58   overfitted <- FALSE ...
R/opls.R#L60   while (!overfitted) { ...
R/opls.R#L76       if (nc == 2) { ...
R/opls.R#L81       } else { ...
R/opls.R#L86       } ...
R/opls.R#L87       pred_comp <- .nipPlsCompRcpp(opls_ ...
R/opls.R#L88       r2x_comp[nc - 1] <- .r2(opls_filt$ ...
R/opls.R#L92       message(sprintf("An O-PLS-%s model ...
R/opls.R#L93       pred_comp$t_o_cv <- matrix(.extMea ...
R/opls.R#L94       pred_comp$t_cv <- matrix(.extMeanC ...
R/opls.R#L95       pred_comp$t_o <- t_orth ...
R/opls.R#L99   } ...
R/opls.R#L101   .finaliseOplsModel( ...
R/opls.R#L123   ) ...
R/opls.R#L129   if (is.data.frame(X)) X <- as.matrix(X ...
R/opls.R#L130   if (!is.logical(center)) stop("Check c ...
R/opls.R#L132   sc_num <- switch(scale, ...
R/opls.R#L133                    "None" = 0, ...
R/opls.R#L134                    "UV" = 1, ...
R/opls.R#L135                    "Pareto" = 2, ...
R/opls.R#L136                    stop("Check scale par ...
R/opls.R#L138   x_check <- .checkXclassNas(X) ...
R/opls.R#L139   y_check <- .checkYclassNas(Y) ...
R/opls.R#L140   .checkDimXY(X, y_check[[1]]) ...
R/opls.R#L142   list(X = X, Y = y_check[[1]], Ydummy = ...
R/opls.R#L143        type = y_check[[3]], scale_code = ...
R/opls.R#L148   cv$cv_sets <- .cvSetsMethod(Y, type, m ...
R/opls.R#L149   cv$k <- length(cv$cv_sets) ...
R/opls.R#L150   cv ...
R/opls.R#L155   if (cv_method == 'MC') { ...
R/opls.R#L157       if (is_multi_Y) { ...
R/opls.R#L161       } else { ...
R/opls.R#L164       } ...
R/opls.R#L165       list(q2 = NA, r2 = NA, aucs_te = a ...
R/opls.R#L167       list(q2 = .r2(YcsTot, preds_test,  ...
R/opls.R#L169   } else { ...
R/opls.R#L171       if (is_multi_Y) { ...
R/opls.R#L175       } else { ...
R/opls.R#L178       } ...
R/opls.R#L179       list(q2 = NA, r2 = NA, aucs_te = a ...
R/opls.R#L181       list(q2 = .r2(YcsTot, preds_test,  ...
R/opls.R#L183   } ...
R/opls.R#L187                                XcsTot, Y ...
R/opls.R#L188                                r2x_comp, ...
R/opls.R#L189                                type, nc, ...
R/opls.R#L190                                original_ ...
R/opls.R#L192   m_summary <- .orthModelCompSummary( ...
R/opls.R#L200   ) ...
R/opls.R#L201   if (plotting) plot(m_summary[[2]]) ...
R/opls.R#L203   # Final matrices ...
R/opls.R#L204   Xorth <- t_orth %*% p_orth ...
R/opls.R#L205   Xpred <- pred_comp$t_x %*% pred_comp$p ...
R/opls.R#L206   E <- XcsTot - (Xpred + Xorth) ...
R/opls.R#L207   Y_res <- YcsTot - (pred_comp$t_y %*% t ...
R/opls.R#L209   # Parameters ...
R/opls.R#L210   pars <- list( ...
R/opls.R#L219   ) ...
R/opls.R#L221   # Return S4 object ...
R/opls.R#L222   new("OPLS_metabom8", ...
R/opls.R#L223       type        = type, ...
R/opls.R#L224       t_pred      = pred_comp$t_x, ...
R/opls.R#L225       p_pred      = pred_comp$p_x, ...
R/opls.R#L226       w_pred      = pred_comp$w_x, ...
R/opls.R#L227       betas_pred  = drop(pred_comp$b), ...
R/opls.R#L228       Qpc         = pred_comp$w_y, ...
R/opls.R#L229       t_pred_cv   = pred_comp$t_cv, ...
R/opls.R#L230       t_orth_cv   = pred_comp$t_o_cv, ...
R/opls.R#L231       t_orth      = t_orth, ...
R/opls.R#L232       w_orth      = w_orth, ...
R/opls.R#L233       p_orth      = p_orth, ...
R/opls.R#L234       nPC         = nc - 1, ...
R/opls.R#L235       summary     = m_summary[[1]], ...
R/opls.R#L236       X_orth      = Xorth, ...
R/opls.R#L237       Y_res       = Y_res, ...
R/opls.R#L238       X_res       = E, ...
R/opls.R#L239       X_mean      = msd_x[[2]], ...
R/opls.R#L240       X_sd        = msd_x[[1]], ...
R/opls.R#L241       Y_mean      = msd_y[[2]], ...
R/opls.R#L242       Y_sd        = msd_y[[1]], ...
R/opls.R#L243       Parameters  = pars, ...
R/opls.R#L244       X           = original_X, ...
R/opls.R#L245       X_scaled    = XcsTot, ...
R/opls.R#L246       Y           = list(ori = original_ ...
R/opls.R#L247   ) ...
R/pca.R#L43   if (is.data.frame(X)) X <- as.matrix(X ...
R/pca.R#L44   if (!is.logical(center)) stop("`center ...
R/pca.R#L45   if (!is.character(scale) || !(scale %i ...
R/pca.R#L47   if (!is.character(method)) stop("`meth ...
R/pca.R#L49   pc_max <- min(ncol(X), nrow(X)) ...
R/pca.R#L50   if (pc > pc_max) { ...
R/pca.R#L53   } ...
R/pca.R#L55   sc_num <- switch(scale, ...
R/pca.R#L56                    "None" = 0, ...
R/pca.R#L57                    "UV" = 1, ...
R/pca.R#L58                    "Pareto" = 2) ...
R/pca.R#L60   # Internal checks and preprocessing ...
R/pca.R#L61   x_check <- .checkXclassNas(X) ...
R/pca.R#L62   msd_x <- .sdRcpp(X) ...
R/pca.R#L63   XcsTot <- .scaleMatRcpp(X, 0:(nrow(X)  ...
R/pca.R#L65   tssx <- .tssRcpp(XcsTot) ...
R/pca.R#L67   if (tolower(method) == "nipals") { ...
R/pca.R#L70       res[[i]] <- if (i == 1) .nipPcaCom ...
R/pca.R#L76       .tssRcpp(Tpc[, i] %o% Ppc[, i]) /  ...
R/pca.R#L81                    type = "NIPALS", ...
R/pca.R#L82                    t = Tpc, ...
R/pca.R#L83                    p = Ppc, ...
R/pca.R#L84                    nPC = pc, ...
R/pca.R#L85                    X_mean = msd_x[[1]], ...
R/pca.R#L86                    X_sd = msd_x[[2]], ...
R/pca.R#L87                    Parameters = pars, ...
R/pca.R#L88                    X = X) ...
R/pca.R#L90   } else { ...
R/pca.R#L97                    type = method, ...
R/pca.R#L98                    t = mod@scores, ...
R/pca.R#L99                    p = mod@loadings, ...
R/pca.R#L100                    nPC = pc, ...
R/pca.R#L101                    X_mean = msd_x[[1]], ...
R/pca.R#L102                    X_sd = msd_x[[2]], ...
R/pca.R#L103                    Parameters = pars, ...
R/pca.R#L104                    X = X) ...
R/pca.R#L105   } ...
R/pca.R#L107   return(mod_pca) ...
R/plotscores.R#L36   # Default PC selection based on model  ...
R/plotscores.R#L37   if (missing(pc)) { ...
R/plotscores.R#L41   } ...
R/plotscores.R#L43   # Determine score type (raw or cross-v ...
R/plotscores.R#L44   etype <- if (cv && grepl("OPLS", class ...
R/plotscores.R#L46   res <- .viz_df_helper(obj, pc, an, typ ...
R/plotscores.R#L47   sc <- res$df ...
R/plotscores.R#L48   type <- if (ncol(sc) > 2 && is.numeric ...
R/plotscores.R#L50   if (is.null(res$an_le) || is.na(res$an ...
R/plotscores.R#L52   # Hotelling's T2 ellipse ...
R/plotscores.R#L53   df <- .hotellingsT2(sc[, 1], sc[, 2]) ...
R/plotscores.R#L55   g <- ggplot() + ...
R/plotscores.R#L57                  fill = NA, colour = "bl ...
R/plotscores.R#L63   # Add points and optional annotation ...
R/plotscores.R#L64   aes_args <- aes(x = !!sym(colnames(sc) ...
R/plotscores.R#L65   if (res$an_le >= 1) { ...
R/plotscores.R#L67   } ...
R/plotscores.R#L68   if (res$an_le >= 2) { ...
R/plotscores.R#L70   } ...
R/plotscores.R#L72   g <- g + geom_point(data = sc, mapping ...
R/plotscores.R#L74   if (type == "continuous") { ...
R/plotscores.R#L76   } ...
R/plotscores.R#L78   if (res$an_le == 3) { ...
R/plotscores.R#L82   } ...
R/plotscores.R#L84   # Add QC points ...
R/plotscores.R#L85   if (!missing(qc) && length(qc) > 0) { ...
R/plotscores.R#L88   } ...
R/plotscores.R#L90   # Axis labeling per model ...
R/plotscores.R#L91   g <- switch(class(obj)[1], ...
R/plotscores.R#L92               "PCA_metabom8" = { ...
R/plotscores.R#L94                   scale_y_continuous(nam ...
R/plotscores.R#L95               }, ...
R/plotscores.R#L96               "OPLS_metabom8" = { ...
R/plotscores.R#L99                   scale_y_continuous(nam ...
R/plotscores.R#L100                   # labs(title = paste0( ...
R/plotscores.R#L101                   #                      ...
R/plotscores.R#L102                   #                      ...
R/plotscores.R#L103                   #                      ...
R/plotscores.R#L104                   #                      ...
R/plotscores.R#L105                   labs(title = paste0("O ...
R/plotscores.R#L106                                       "  ...
R/plotscores.R#L107                                       if ...
R/plotscores.R#L108                                       ") ...
R/plotscores.R#L109                   theme(plot.title = ele ...
R/plotscores.R#L110               }, ...
R/plotscores.R#L111               "PLS_metabom8" = { ...
R/plotscores.R#L114                   scale_y_continuous(nam ...
R/plotscores.R#L115                   labs(title = paste0("P ...
R/plotscores.R#L116                                       "  ...
R/plotscores.R#L117                                       if ...
R/plotscores.R#L118                                       ") ...
R/plotscores.R#L119                   theme(plot.title = ele ...
R/plotscores.R#L120               }, ...
R/plotscores.R#L121               g ...
R/plotscores.R#L122   ) ...
R/plotscores.R#L124   # Legend positioning ...
R/plotscores.R#L125   if (legend == "in") { ...
R/plotscores.R#L127   } else if (is.na(legend)) { ...
R/plotscores.R#L129   } ...
R/plotscores.R#L131   return(g) ...
R/pls.r#L46   prep <- .prepareInputsPLS(X, Y, center ...
R/pls.r#L47   type <- prep$y_check[[3]] ...
R/pls.r#L49   fit <- .runPlsCVLoop( ...
R/pls.r#L52   ) ...
R/pls.r#L54   mod_summary <- .plsModelCompSummary( ...
R/pls.r#L62   ) ...
R/pls.r#L63   if (plotting) plot(mod_summary[[2]]) ...
R/pls.r#L65   pars <- list( ...
R/pls.r#L75   ) ...
R/pls.r#L77   .finalisePlsModel(fit$full_mod, prep$X ...
R/pls.r#L82   if (is.data.frame(X)) X <- as.matrix(X ...
R/pls.r#L83   if (!is.logical(center)) stop("Invalid ...
R/pls.r#L85   sc_num <- switch(scale, ...
R/pls.r#L86                    "None" = 0, ...
R/pls.r#L87                    "UV" = 1, ...
R/pls.r#L88                    "Pareto" = 2, ...
R/pls.r#L89                    stop("Invalid 'scale' ...
R/pls.r#L90   ) ...
R/pls.r#L92   y_check <- .checkYclassNas(Y) ...
R/pls.r#L93   x_check <- .checkXclassNas(X) ...
R/pls.r#L94   .checkDimXY(X, y_check[[1]]) ...
R/pls.r#L96   Xcs <- .scaleMatRcpp(X, 0:(nrow(X) - 1 ...
R/pls.r#L97   Ycs <- .scaleMatRcpp(y_check[[1]], 0:( ...
R/pls.r#L99   Y <- as.matrix(Y)[, 1, drop = FALSE] ...
R/pls.r#L101   list( ...
R/pls.r#L109   ) ...
R/pls.r#L113   cv_sets <- .cvSetsMethod(Y = Y_, type  ...
R/pls.r#L114   preds <- list() ...
R/pls.r#L115   full_mod <- list() ...
R/pls.r#L116   r2_comp <- r2x_comp <- q2_comp <- aucs ...
R/pls.r#L117   overfitted <- FALSE ...
R/pls.r#L118   nc <- 1 ...
R/pls.r#L120   while (!overfitted) { ...
R/pls.r#L122       .plsComponentCv(Xcs, Y = Y_, cv_se ...
R/pls.r#L124       .plsComponentCv(NA, Y = Y_, cv_set ...
R/pls.r#L137       full_mod[[1]] <- .nipPlsCompRcpp(X ...
R/pls.r#L139       Xinp <- full_mod[[nc - 1]]$x_res ...
R/pls.r#L140       full_mod[[nc]] <- .nipPlsCompRcpp( ...
R/pls.r#L146   } ...
R/pls.r#L148   list( ...
R/pls.r#L156   ) ...
R/pls.r#L160   is_multi_Y <- grepl('mY', type) ...
R/pls.r#L161   is_DA <- grepl('DA', type) ...
R/pls.r#L163   result <- list(r2 = NA, q2 = NA, auc_t ...
R/pls.r#L165   if (grepl('MC', cv_method) || grepl('k ...
R/pls.r#L167       if (is_multi_Y) { ...
R/pls.r#L172       } else { ...
R/pls.r#L177       } ...
R/pls.r#L179       result$r2 <- .r2(Ycs, preds_train, ...
R/pls.r#L180       result$q2 <- .r2(Ycs, preds_test,  ...
R/pls.r#L182   } ...
R/pls.r#L183   result ...
R/pls.r#L187   t_x <- do.call(cbind, lapply(mod_list, ...
R/pls.r#L188   p_x <- do.call(rbind, lapply(mod_list, ...
R/pls.r#L189   w_x <- do.call(rbind, lapply(mod_list, ...
R/pls.r#L190   b   <- do.call(rbind, lapply(mod_list, ...
R/pls.r#L191   w_y <- do.call(rbind, lapply(mod_list, ...
R/pls.r#L193   Xpred <- t_x %*% p_x ...
R/pls.r#L194   E <- XcsTot - Xpred ...
R/pls.r#L195   Y_res <- YcsTot - (mod_list[[length(mo ...
R/pls.r#L197   new("PLS_metabom8", ...
R/pls.r#L198       type = type, ...
R/pls.r#L199       t_pred = t_x, ...
R/pls.r#L200       p_pred = p_x, ...
R/pls.r#L201       w_pred = w_x, ...
R/pls.r#L202       betas_pred = drop(b), ...
R/pls.r#L203       Qpc = w_y, ...
R/pls.r#L204       t_pred_cv = t_x, ...
R/pls.r#L205       nPC = length(mod_list), ...
R/pls.r#L206       summary = summary, ...
R/pls.r#L207       Y_res = Y_res, ...
R/pls.r#L208       X_res = E, ...
R/pls.r#L209       X_mean = msd_x[[2]], ...
R/pls.r#L210       X_sd = msd_x[[1]], ...
R/pls.r#L211       Y_mean = msd_y[[2]], ...
R/pls.r#L212       Y_sd = msd_y[[1]], ...
R/pls.r#L213       Parameters = pars, ...
R/pls.r#L214       X = XcsTot, ...
R/pls.r#L215       X_scaled = XcsTot, ...
R/pls.r#L216       Y = list(ori = Y, dummy = YcsTot) ...
R/pls.r#L217   ) ...
R/plsComponentCv.R#L14   out <- lapply(seq_along(cv.set), funct ...
R/plsComponentCv.R#L18       Xcs <- .scaleMatRcpp(X, idc - 1, c ...
R/plsComponentCv.R#L20       Xcs <- mod.cv[[k]]$x_res ...
R/plsComponentCv.R#L32       mod.cv <- list( ...
R/plsComponentCv.R#L37       ) ...
R/plsComponentCv.R#L39       mod.cv$t_xp[-idc, nc] <- pls_pred$ ...
R/plsComponentCv.R#L40       mod.cv$y_pred_train[idc, ] <- pred ...
R/plsComponentCv.R#L41       mod.cv$y_pred_test[-idc, ] <- pls_ ...
R/plsComponentCv.R#L42       mod.cv$x_res[idc, ] <- pred_comp$x ...
R/plsComponentCv.R#L43       mod.cv$x_res[-idc, ] <- pls_pred$X ...
R/plsComponentCv.R#L45       return(mod.cv) ...
R/plsComponentCv.R#L47       t_xp <- matrix(NA, nrow = nrow(Y), ...
R/plsComponentCv.R#L48       t_xp[-idc, 1] <- pls_pred$t_pred ...
R/plsComponentCv.R#L49       mod.cv[[k]]$t_xp <- cbind(mod.cv[[ ...
R/plsComponentCv.R#L51       mod.cv[[k]]$y_pred_test <- { ...
R/plsComponentCv.R#L55       } ...
R/plsComponentCv.R#L57       mod.cv[[k]]$y_pred_train <- { ...
R/plsComponentCv.R#L61       } ...
R/plsComponentCv.R#L63       mod.cv[[k]]$x_res[idc, ] <- pred_c ...
R/plsComponentCv.R#L64       mod.cv[[k]]$x_res[-idc, ] <- pls_p ...
R/plsComponentCv.R#L66       return(mod.cv[[k]]) ...
R/plsComponentCv.R#L68   }) ...
R/plsComponentCv.R#L70   return(out) ...
R/ppick.R#L36   X <- .dimX(X) ...
R/ppick.R#L38   if (!.check_X_ppm(X, ppm)) { ...
R/ppick.R#L40   } ...
R/ppick.R#L42   if (!(type %in% c("max", "min", "both" ...
R/ppick.R#L44   } ...
R/ppick.R#L46   apply(X, 1, function(x, pp = ppm) { ...
R/ppick.R#L58       idc = extrema_idx, ...
R/ppick.R#L59       ppm = pp[extrema_idx], ...
R/ppick.R#L60       Int = x[extrema_idx], ...
R/ppick.R#L61       Etype = extrema_type ...
R/ppick.R#L65            "max" = res[res$Etype > 0, ], ...
R/ppick.R#L66            "min" = res[res$Etype < 0, ], ...
R/ppick.R#L67            "both" = res ...
R/ppick.R#L69   }) ...
R/pqn.R#L35   if (is.data.frame(X)) X <- as.matrix(X ...
R/pqn.R#L36   nams <- rownames(X) ...
R/pqn.R#L38   if (!is.null(bin)) { ...
R/pqn.R#L40       stop("Argument 'bin' must be a nam ...
R/pqn.R#L44       bin$ppm <- as.numeric(colnames(X)) ...
R/pqn.R#L48       stop("Mismatch between X and ppm i ...
R/pqn.R#L52   } else { ...
R/pqn.R#L54   } ...
R/pqn.R#L56   # Total area normalisation ...
R/pqn.R#L57   if (TArea) { ...
R/pqn.R#L59   } ...
R/pqn.R#L61   # Determine reference spectrum ...
R/pqn.R#L62   ref <- if (is.null(iref)) { ...
R/pqn.R#L64   } else { ...
R/pqn.R#L68   } ...
R/pqn.R#L70   ref[ref == 0] <- 1e-4 ...
R/pqn.R#L72   # Compute dilution factors ...
R/pqn.R#L73   dil_F <- 1 / apply(X1, 1, function(x)  ...
R/pqn.R#L75   # Apply PQN ...
R/pqn.R#L76   X_pqn <- sweep(X, 1, dil_F, "*") ...
R/pqn.R#L78   if (!is.null(add_DilF)) { ...
R/pqn.R#L80   } ...
R/pqn.R#L82   rownames(X_pqn) <- nams ...
R/pqn.R#L83   return(X_pqn) ...
R/predict_opls.R#L39   if (!inherits(opls_model, "OPLS_metabo ...
R/predict_opls.R#L41   } ...
R/predict_opls.R#L43   if (opls_model@type == "DA" && length( ...
R/predict_opls.R#L45   } ...
R/predict_opls.R#L47   X <- if (is.null(ncol(newdata))) rbind ...
R/predict_opls.R#L49   if (length(opls_model@X_mean) != ncol( ...
R/predict_opls.R#L51   } ...
R/predict_opls.R#L53   # Scaling ...
R/predict_opls.R#L54   if (!is.null(idx_scale)) { ...
R/predict_opls.R#L61   } else { ...
R/predict_opls.R#L64   } ...
R/predict_opls.R#L66   # Remove orthogonal variation ...
R/predict_opls.R#L67   e_new_orth <- X ...
R/predict_opls.R#L68   n_pcOorth <- opls_model@nPC - 1 ...
R/predict_opls.R#L69   t_orth <- matrix(NA, nrow = nrow(X), n ...
R/predict_opls.R#L71   for (i in seq_len(n_pcOorth)) { ...
R/predict_opls.R#L76   } ...
R/predict_opls.R#L78   t_orth_pca <- if (n_pcOorth > 1) { ...
R/predict_opls.R#L81   } else { ...
R/predict_opls.R#L83   } ...
R/predict_opls.R#L85   # Predict using model ...
R/predict_opls.R#L86   t_pred <- e_new_orth %*% opls_model@w_ ...
R/predict_opls.R#L87   betas <- opls_model@betas_pred ...
R/predict_opls.R#L88   q_h <- opls_model@Qpc ...
R/predict_opls.R#L89   res <- matrix(NA, nrow = nrow(X), ncol ...
R/predict_opls.R#L91   for (i in seq_len(ncol(opls_model@t_pr ...
R/predict_opls.R#L93   } ...
R/predict_opls.R#L95   totalPrediction <- rowSums(res) ...
R/predict_opls.R#L96   Y_predicted <- (totalPrediction * opls ...
R/predict_opls.R#L98   if (opls_model@type == "DA") { ...
R/predict_opls.R#L101                        Numeric = as.nume ...
R/predict_opls.R#L102                        stringsAsFactors  ...
R/predict_opls.R#L104   } ...
R/predict_opls.R#L106   return(list( ...
R/predict_opls.R#L111   )) ...
R/RawGenerics.R#L3   idx <- seq_len(n) ...
R/RawGenerics.R#L4   out <- exp(-(idx * lb * pi) / n) ...
R/RawGenerics.R#L5   minmax(out) ...
R/RawGenerics.R#L10   idx <- seq_len(n) ...
R/RawGenerics.R#L11   out <- cos(pi * idx / n) ...
R/RawGenerics.R#L12   minmax(out) ...
R/RawGenerics.R#L17   idx <- seq_len(n) ...
R/RawGenerics.R#L18   out <- sin(pi * idx / n) ...
R/RawGenerics.R#L19   minmax(out) ...
R/RawGenerics.R#L24   idx <- seq_len(n) ...
R/RawGenerics.R#L25   out <- sin(pi * idx / n) * exp(-(idx * ...
R/RawGenerics.R#L26   minmax(out) ...
R/RawGenerics.R#L31   idx <- seq_len(n) ...
R/RawGenerics.R#L32   b <- -lb / (2 * gb * aq_t) ...
R/RawGenerics.R#L33   out <- exp((-lb * idx) - (b * idx^2)) ...
R/RawGenerics.R#L34   minmax(out) ...
R/RawGenerics.R#L39   sw_hz <- para$a_SW_h ...
R/RawGenerics.R#L40   AQ <- para$a_TD / (2 * sw_hz) ...
R/RawGenerics.R#L41   idx <- seq_len(n) - 1 ...
R/RawGenerics.R#L42   e <- (-pi * idx * lb) / sw_hz ...
R/RawGenerics.R#L43   g <- ((lb * pi) / (2 * gb * AQ)) * (id ...
R/RawGenerics.R#L44   out <- exp(e - g^2) ...
R/RawGenerics.R#L45   minmax(out) ...
R/RawGenerics.R#L55   if (is.null(pars$fun) || !pars$fun %in ...
R/RawGenerics.R#L57   } ...
R/RawGenerics.R#L59   afun <- switch(pars$fun, ...
R/RawGenerics.R#L60                  "uniform" = rep(1, n), ...
R/RawGenerics.R#L61                  "exponential" = { ...
R/RawGenerics.R#L62                    if (!"lb" %in% names( ...
R/RawGenerics.R#L63                    .em(n, pars$lb) ...
R/RawGenerics.R#L64                  }, ...
R/RawGenerics.R#L65                  "cosine" = .cosine(n), ...
R/RawGenerics.R#L66                  "sine" = .sine(n), ...
R/RawGenerics.R#L67                  "sem" = { ...
R/RawGenerics.R#L68                    if (!"lb" %in% names( ...
R/RawGenerics.R#L69                    .sem(n, pars$lb) ...
R/RawGenerics.R#L70                  }, ...
R/RawGenerics.R#L71                  "expGaus_resyG" = { ...
R/RawGenerics.R#L72                    if (!all(c("lb", "gb" ...
R/RawGenerics.R#L73                      stop("expGaus_resyG ...
R/RawGenerics.R#L74                    } ...
R/RawGenerics.R#L75                    .expGaus_resyG(n, par ...
R/RawGenerics.R#L76                  }, ...
R/RawGenerics.R#L77                  "gauss" = { ...
R/RawGenerics.R#L78                    if (!all(c("lb", "gb" ...
R/RawGenerics.R#L79                      stop("Gaussian apod ...
R/RawGenerics.R#L80                    } ...
R/RawGenerics.R#L81                    .gauss(n, pars$lb, pa ...
R/RawGenerics.R#L82                  } ...
R/RawGenerics.R#L83   ) ...
R/RawGenerics.R#L85   if (!is.null(pars$plot) && isTRUE(pars ...
R/RawGenerics.R#L87   } ...
R/RawGenerics.R#L89   return(afun) ...
R/RawGenerics.R#L104   idx <- match(toupper(names(exp_type)), ...
R/RawGenerics.R#L105   if (length(idx) == 0) { ...
R/RawGenerics.R#L107   } ...
R/RawGenerics.R#L109   idx_na <- which(is.na(idx)) ...
R/RawGenerics.R#L110   if (length(idx_na) > 0) { ...
R/RawGenerics.R#L112       stop("No matching parameter names  ...
R/RawGenerics.R#L114       message(sprintf("Experiment filter ...
R/RawGenerics.R#L115                       paste(names(exp_ty ...
R/RawGenerics.R#L116                       paste(names(exp_ty ...
R/RawGenerics.R#L117       idx <- idx[-idx_na] ...
R/RawGenerics.R#L119   } ...
R/RawGenerics.R#L121   fmat <- vapply(seq_along(idx), functio ...
R/RawGenerics.R#L124   }, logical(nrow(pars))) ...
R/RawGenerics.R#L126   # idx_filt <- apply(fmat == 1, 1, all) ...
R/RawGenerics.R#L127   if (is.matrix(fmat) && nrow(fmat) > 0) ...
R/RawGenerics.R#L129   } else { ...
R/RawGenerics.R#L132   } ...
R/RawGenerics.R#L133   if (all(!idx_filt)) { ...
R/RawGenerics.R#L135   } ...
R/RawGenerics.R#L137   f_list <- lapply(f_list, function(x) x ...
R/RawGenerics.R#L138   idx_filt <- which(idx_filt) ...
R/RawGenerics.R#L140   if (length(idx_filt) > n_max) { ...
R/RawGenerics.R#L143   } ...
R/RawGenerics.R#L145   pars <- pars[idx_filt, ] ...
R/RawGenerics.R#L146   fnam <- strsplit(ifelse(!(any(is.na(f_ ...
R/RawGenerics.R#L147   # fnam <- strsplit(ifelse(!(is.na(f_li ...
R/RawGenerics.R#L149   fmat_comb <- do.call(rbind, fnam) ...
R/RawGenerics.R#L150   uniq_cols <- vapply(seq_len(ncol(fmat_ ...
R/RawGenerics.R#L151   idx_keep <- which(uniq_cols) ...
R/RawGenerics.R#L153   if (length(idx_keep) > 1) { ...
R/RawGenerics.R#L155       c(fnam[[i]][idx_keep[length(idx_ke ...
R/RawGenerics.R#L168       exp_ <- factor(exp_) ...
R/RawGenerics.R#L175   } else { ...
R/RawGenerics.R#L178       exp_ <- factor(exp_) ...
R/RawGenerics.R#L181   } ...
R/RawGenerics.R#L183   pars <- pars[rr, ] ...
R/RawGenerics.R#L184   f_list <- lapply(f_list, function(x) x ...
R/RawGenerics.R#L185   pars$a_DATE <- as.POSIXct(pars$a_DATE) ...
R/RawGenerics.R#L187   return(list(f_list, pars)) ...
R/RawGenerics.R#L199   out <- lapply(f_list[[1]], function(fi ...
R/RawGenerics.R#L207       gsub(" .*", f_acqu[i + 1], f_acqu[ ...
R/RawGenerics.R#L216       as.POSIXct("1970-01-01 00:00:00",  ...
R/RawGenerics.R#L221   }) ...
R/RawGenerics.R#L223   if (is.list(out)) { ...
R/RawGenerics.R#L226       out <- do.call(rbind, out) ...
R/RawGenerics.R#L228       unam <- unique(names(unlist(out))) ...
R/RawGenerics.R#L229       out <- do.call(rbind, lapply(out,  ...
R/RawGenerics.R#L230       colnames(out) <- unam ...
R/RawGenerics.R#L232   } ...
R/RawGenerics.R#L234   if (nrow(out) != length(f_list[[1]]))  ...
R/RawGenerics.R#L236   } ...
R/RawGenerics.R#L238   out <- as.data.frame(out, stringsAsFac ...
R/RawGenerics.R#L239   dtype_num <- vapply(out, function(x) . ...
R/RawGenerics.R#L240   # dtype_num <- vapply(out, function(x) ...
R/RawGenerics.R#L241   out[, dtype_num] <- lapply(out[, dtype ...
R/RawGenerics.R#L242   rownames(out) <- f_list[[2]] ...
R/RawGenerics.R#L244   return(out) ...
R/RawGenerics.R#L259   datapath <- gsub(paste0(.Platform$file ...
R/RawGenerics.R#L261   f_acqus <- list.files(datapath, patter ...
R/RawGenerics.R#L262   f_fid <- list.files(datapath, pattern  ...
R/RawGenerics.R#L264   id_a <- gsub(paste("^", datapath, "/|/ ...
R/RawGenerics.R#L265   id_fid <- gsub(paste("^", datapath, "/ ...
R/RawGenerics.R#L267   idx_a <- which(id_a %in% id_fid) ...
R/RawGenerics.R#L268   idx_fid <- which(id_fid %in% id_a) ...
R/RawGenerics.R#L270   if (length(idx_a) != length(id_a) || l ...
R/RawGenerics.R#L272       if (verbose > 1) { ...
R/RawGenerics.R#L274       } ...
R/RawGenerics.R#L275       f_acqus <- f_acqus[idx_a] ...
R/RawGenerics.R#L276       id_a <- id_a[idx_a] ...
R/RawGenerics.R#L277       f_fid <- f_fid[idx_fid] ...
R/RawGenerics.R#L278       id_fid <- id_fid[idx_fid] ...
R/RawGenerics.R#L280       message("File system appears to be ...
R/RawGenerics.R#L281       return(NULL) ...
R/RawGenerics.R#L283   } ...
R/RawGenerics.R#L285   idm_fid <- match(id_a, id_fid) ...
R/RawGenerics.R#L286   if (any(is.na(idm_fid)) || any(diff(id ...
R/RawGenerics.R#L288   } ...
R/RawGenerics.R#L290   if (length(unique(c(length(f_acqus), l ...
R/RawGenerics.R#L292   } ...
R/RawGenerics.R#L294   if (n_max < length(f_fid)) { ...
R/RawGenerics.R#L300   } ...
R/RawGenerics.R#L302   p_intact <- gsub("/acqus$", "", f_acqu ...
R/RawGenerics.R#L303   exp_no <- id_fid ...
R/RawGenerics.R#L305   return(list(path = p_intact, exp_no =  ...
R/read1d_raw.R#L45                        exp_type = list(e ...
R/read1d_raw.R#L46                        apodisation = lis ...
R/read1d_raw.R#L47                        zerofil = 1L, ...
R/read1d_raw.R#L48                        return = "absorpt ...
R/read1d_raw.R#L49                        verbose = 1, ...
R/read1d_raw.R#L50                        recursive = TRUE, ...
R/read1d_raw.R#L51                        n_max = 1000, ...
R/read1d_raw.R#L52                        filter = TRUE) { ...
R/read1d_raw.R#L54   path <- path.expand(path) ...
R/read1d_raw.R#L55   return <- match.arg(return, c("absorpt ...
R/read1d_raw.R#L57   if (verbose > 1) message("Searching fo ...
R/read1d_raw.R#L58   f_list <- .check1d_files_fid(path, n_m ...
R/read1d_raw.R#L60   if (verbose > 1) message("Found ", len ...
R/read1d_raw.R#L62   if (verbose > 1) message("Extracting s ...
R/read1d_raw.R#L63   pars <- .extract_acq_pars1d(f_list) ...
R/read1d_raw.R#L65   if (verbose > 1) message("Filtering ex ...
R/read1d_raw.R#L66   exp_filt <- .filterExp_files(pars, exp ...
R/read1d_raw.R#L67   f_list <- exp_filt[[1]] ...
R/read1d_raw.R#L68   pars <- exp_filt[[2]] ...
R/read1d_raw.R#L70   if (verbose > 0) message("Reading ", l ...
R/read1d_raw.R#L72   if (length(unique(pars$a_TD)) > 2 || l ...
R/read1d_raw.R#L74   } ...
R/read1d_raw.R#L76   ppm_ref <- .defineChemShiftPpm( ...
R/read1d_raw.R#L79   )[, 1] ...
R/read1d_raw.R#L80   ppm_ref <- ppm_ref - ppm_ref[which.min ...
R/read1d_raw.R#L82   if (verbose >= 2) message("Defining ap ...
R/read1d_raw.R#L83   apoFct <- .fidApodisationFct(n = (pars ...
R/read1d_raw.R#L85   if (verbose > 1) message("Reading FIDs ...
R/read1d_raw.R#L87   out <- vapply(seq_along(f_list[[1]]),  ...
R/read1d_raw.R#L94       file.path(f_list[[1]][s], "fid"), ...
R/read1d_raw.R#L95       what = names(dtypa)[match(pars$a_D ...
R/read1d_raw.R#L96       n = pars$a_TD[s], size = 4L, ...
R/read1d_raw.R#L97       endian = names(byteorda)[match(par ...
R/read1d_raw.R#L115                                dref = 4. ...
R/read1d_raw.R#L119       sp_re <- -sp_re ...
R/read1d_raw.R#L122                        idx_tsp = get_idx ...
R/read1d_raw.R#L124       sp_re <- -sp_re ...
R/read1d_raw.R#L130                      absorption = sp_re, ...
R/read1d_raw.R#L131                      dispersion = sp_im, ...
R/read1d_raw.R#L132                      magnitude = sp_mag) ...
R/read1d_raw.R#L137   }, FUN.VALUE = ppm_ref) ...
R/read1d_raw.R#L139   out <- t(out) ...
R/read1d_raw.R#L140   colnames(out) <- ppm_ref ...
R/read1d_raw.R#L142   fnam <- strsplit(f_list[[1]], .Platfor ...
R/read1d_raw.R#L143   idx_keep <- which(apply(do.call(rbind, ...
R/read1d_raw.R#L144   fnam <- vapply(fnam, function(x) paste ...
R/read1d_raw.R#L145   rownames(out) <- fnam ...
R/read1d_raw.R#L146   rownames(pars) <- fnam ...
R/read1d_raw.R#L148   if (verbose > 0) message("Assigning ob ...
R/read1d_raw.R#L149   assign("X", out, envir = .GlobalEnv) ...
R/read1d_raw.R#L150   assign("ppm", ppm_ref, envir = .Global ...
R/read1d_raw.R#L151   assign("meta", pars, envir = .GlobalEn ...
R/read1d.R#L31                    exp_type = list(pulpr ...
R/read1d.R#L32                    n_max = 1000, ...
R/read1d.R#L33                    filter = TRUE, ...
R/read1d.R#L34                    recursive = TRUE, ...
R/read1d.R#L35                    verbose = 1) { ...
R/read1d.R#L36   path <- path.expand(path) ...
R/read1d.R#L38   if (as.character(match.call()[[1]]) == ...
R/read1d.R#L40   } ...
R/read1d.R#L42   f_list <- .detect1d_procs(path, n_max  ...
R/read1d.R#L43   if (is.null(f_list)) stop("No valid ex ...
R/read1d.R#L45   pars <- .extract_pars1d(f_list) ...
R/read1d.R#L46   exp_filt <- .filterExp_files(pars, exp ...
R/read1d.R#L47   f_list <- exp_filt[[1]] ...
R/read1d.R#L48   pars <- exp_filt[[2]] ...
R/read1d.R#L50   ppm_ref <- .chemShift(swidth = pars$a_ ...
R/read1d.R#L52   out <- vapply(seq_along(f_list[[1]]),  ...
R/read1d.R#L56       f_list$f_1r[s], what = "int", n =  ...
R/read1d.R#L57       signed = TRUE, endian = names(byte ...
R/read1d.R#L62   }, FUN.VALUE = numeric(length(ppm_ref) ...
R/read1d.R#L64   out <- t(out) ...
R/read1d.R#L65   colnames(out) <- ppm_ref ...
R/read1d.R#L67   fnam <- vapply(strsplit(f_list$f_1r, . ...
R/read1d.R#L69   }, character(1)) ...
R/read1d.R#L71   rownames(out) <- fnam ...
R/read1d.R#L72   rownames(pars) <- fnam ...
R/read1d.R#L73   out[is.na(out)] <- 0 ...
R/read1d.R#L75   assign("X", out, envir = .GlobalEnv) ...
R/read1d.R#L76   assign("ppm", ppm_ref, envir = .Global ...
R/read1d.R#L77   assign("meta", pars, envir = .GlobalEn ...
R/read1d.R#L79   if (verbose) message("Imported ", nrow ...
R/read1d.R#L81   invisible(list(X = out, ppm = ppm_ref, ...
R/read1d.R#L101   out <- lapply(seq_along(f_list[[1]]),  ...
R/read1d.R#L106       gsub(" .*", f_procs_lines[j + 1],  ...
R/read1d.R#L116       gsub(" .*", f_acqus_lines[j + 1],  ...
R/read1d.R#L125       as.POSIXct("1970-01-01 00:00:00",  ...
R/read1d.R#L129   }) ...
R/read1d.R#L131   # Handle unequal metadata entries ...
R/read1d.R#L132   out_len <- vapply(out, length, FUN.VAL ...
R/read1d.R#L133   if (length(unique(out_len)) > 1) { ...
R/read1d.R#L136       out_row <- setNames(rep(NA, length ...
R/read1d.R#L137       out_row[names(x)] <- x ...
R/read1d.R#L138       out_row ...
R/read1d.R#L140   } ...
R/read1d.R#L142   out_df <- as.data.frame(do.call(rbind, ...
R/read1d.R#L144   is_num <- vapply(out_df, .is_numeric_t ...
R/read1d.R#L145   # is_num <- vapply(out_df, function(co ...
R/read1d.R#L146   out_df[is_num] <- lapply(out_df[is_num ...
R/read1d.R#L148   rownames(out_df) <- f_list[[2]] ...
R/read1d.R#L149   return(out_df) ...
R/read1d.R#L181   stopifnot(is.character(datapath), leng ...
R/read1d.R#L182   stopifnot(is.numeric(n_max), length(n_ ...
R/read1d.R#L183   stopifnot(is.logical(filter), length(f ...
R/read1d.R#L184   stopifnot(is.logical(recursive), lengt ...
R/read1d.R#L185   stopifnot(is.numeric(verbose), length( ...
R/read1d.R#L187   datapath <- gsub(paste0(.Platform$file ...
R/read1d.R#L189   # List files matching patterns recursi ...
R/read1d.R#L190   f_procs <- list.files(path = datapath, ...
R/read1d.R#L192   f_acqus <- list.files(path = datapath, ...
R/read1d.R#L194   f_1r <- list.files(path = datapath, pa ...
R/read1d.R#L195                      recursive = TRUE, i ...
R/read1d.R#L197   # Extract experiment IDs by trimming k ...
R/read1d.R#L198   pattern_acqus <- paste0("^", datapath, ...
R/read1d.R#L199   pattern_procs <- paste0("^", datapath, ...
R/read1d.R#L200   pattern_1r <- paste0("^", datapath, .P ...
R/read1d.R#L202   id_a <- gsub(pattern_acqus, "", f_acqu ...
R/read1d.R#L203   id_p <- gsub(pattern_procs, "", f_proc ...
R/read1d.R#L204   id_f1r <- gsub(pattern_1r, "", f_1r) ...
R/read1d.R#L206   # Find matching indices (keep only mat ...
R/read1d.R#L207   idx_a <- which(id_a %in% id_f1r) ...
R/read1d.R#L208   idx_p <- which(id_p %in% id_f1r) ...
R/read1d.R#L209   idx_f1r <- which(id_f1r %in% id_a) ...
R/read1d.R#L211   # Filter incomplete sets if requested ...
R/read1d.R#L212   if (length(idx_a) != length(id_a) || l ...
R/read1d.R#L214       if (verbose > 1) { ...
R/read1d.R#L216       } ...
R/read1d.R#L217       f_acqus <- f_acqus[idx_a] ...
R/read1d.R#L218       id_a <- id_a[idx_a] ...
R/read1d.R#L219       f_procs <- f_procs[idx_p] ...
R/read1d.R#L220       id_p <- id_p[idx_p] ...
R/read1d.R#L221       f_1r <- f_1r[idx_f1r] ...
R/read1d.R#L222       id_f1r <- id_f1r[idx_f1r] ...
R/read1d.R#L224       message("File system seems to be c ...
R/read1d.R#L225       return(NULL) ...
R/read1d.R#L227   } ...
R/read1d.R#L229   # Ensure matching between acqus, procs ...
R/read1d.R#L230   idm_f1r <- match(id_a, id_f1r) ...
R/read1d.R#L231   idm_p <- match(id_a, id_p) ...
R/read1d.R#L232   if (any(is.na(idm_f1r)) || any(is.na(i ...
R/read1d.R#L234   } ...
R/read1d.R#L236   f_procs <- f_procs[idm_p] ...
R/read1d.R#L237   f_1r <- f_1r[idm_f1r] ...
R/read1d.R#L238   id_f1r <- id_f1r[idm_f1r] ...
R/read1d.R#L240   # Sanity check lengths are consistent ...
R/read1d.R#L241   if (length(unique(c(length(f_acqus), l ...
R/read1d.R#L243   } ...
R/read1d.R#L245   # Limit to n_max spectra ...
R/read1d.R#L246   if (n_max < length(f_1r)) { ...
R/read1d.R#L253   } ...
R/read1d.R#L255   # Remove trailing "/acqus" from path f ...
R/read1d.R#L256   p_intact <- gsub(paste0(.Platform$file ...
R/read1d.R#L258   # Return list of intact experiment dat ...
R/read1d.R#L259   return(list( ...
R/read1d.R#L265   )) ...
R/read1d.R#L282   dppm <- swidth / (si - 1) ...
R/read1d.R#L283   seq(offset, offset - swidth, by = -dpp ...
R/stocsy.R#L28   if (!hasArg(ppm)) { ...
R/stocsy.R#L31   } ...
R/stocsy.R#L33   extD <- FALSE ...
R/stocsy.R#L34   if (length(driver) > 1) { ...
R/stocsy.R#L40   } ...
R/stocsy.R#L42   if (!is.matrix(X) && !is.data.frame(X) ...
R/stocsy.R#L43   if (!is.numeric(driver) || (!extD && ( ...
R/stocsy.R#L45   } ...
R/stocsy.R#L47   # Determine driver signal ...
R/stocsy.R#L48   l <- if (extD) driver else X[, which.m ...
R/stocsy.R#L50   # Compute correlation and covariance ...
R/stocsy.R#L51   cc <- apply(X, 2, function(x) cor(x, l ...
R/stocsy.R#L52   cv <- apply(X, 2, function(x) cov(x, l ...
R/stocsy.R#L54   stoc_mod <- new("stocsy1d_metabom8", v ...
R/stocsy.R#L55                   driver = driver, r = c ...
R/stocsy.R#L57   if (plotting) { ...
R/stocsy.R#L61       extD_stats <- round(summary(driver ...
R/stocsy.R#L62       paste0("Sample size: n=", length(d ...
R/stocsy.R#L63              extD_stats[3], " Range=", e ...
R/stocsy.R#L65       paste0("Sample size: n=", nrow(X)) ...
R/stocsy.R#L69       geom_line() + ...
R/stocsy.R#L70       scale_x_reverse(breaks = breaks_pr ...
R/stocsy.R#L71       scale_colour_gradientn(colours = m ...
R/stocsy.R#L72       labs(x = expression(delta^1 * H ~  ...
R/stocsy.R#L73            y = gsub("^r", "cov", csc_lab ...
R/stocsy.R#L74            title = title, caption = capt ...
R/stocsy.R#L75       theme_bw() + ...
R/stocsy.R#L76       theme(axis.text = element_text(col ...
R/stocsy.R#L80       g1 <- g1 + geom_vline(xintercept = ...
R/stocsy.R#L84   } ...
R/stocsy.R#L86   return(stoc_mod) ...
R/stocsy.R#L113   if (!inherits(stoc_mod, "stocsy1d_meta ...
R/stocsy.R#L114   if (!is.numeric(shift) || length(shift ...
R/stocsy.R#L116   ds <- data.frame(r = stoc_mod@r, cov = ...
R/stocsy.R#L117   extD <- length(stoc_mod@driver) > 1 ...
R/stocsy.R#L119   # Clamp shift range to available ppm r ...
R/stocsy.R#L120   shift[1] <- max(shift[1], min(ds$ppm)) ...
R/stocsy.R#L121   shift[2] <- min(shift[2], max(ds$ppm)) ...
R/stocsy.R#L122   shift <- sort(shift) ...
R/stocsy.R#L124   idx <- which(ds$ppm >= shift[1] & ds$p ...
R/stocsy.R#L125   if (length(idx) == 0) stop("No ppm val ...
R/stocsy.R#L126   ds <- ds[idx, ] ...
R/stocsy.R#L128   csc_lab <- if (extD) "r(ext, X)" else  ...
R/stocsy.R#L129   caption <- if (extD) { ...
R/stocsy.R#L132            "\nExternal driver: Median=", ...
R/stocsy.R#L133            " Range=", extD_stats[1], "-" ...
R/stocsy.R#L134   } else { ...
R/stocsy.R#L136   } ...
R/stocsy.R#L138   ds$r_abs <- abs(ds$r) ...
R/stocsy.R#L140   g1 <- ggplot(ds, aes(x = !!sym("ppm"), ...
R/stocsy.R#L145          y = gsub("^r", "cov", csc_lab), ...
R/stocsy.R#L146          title = title, caption = captio ...
R/stocsy.R#L151   if (!extD && shift[1] < stoc_mod@drive ...
R/stocsy.R#L153   } ...
R/stocsy.R#L155   return(g1) ...
R/storm.R#L35   # center X, define reference index and ...
R/storm.R#L36   X_sc <- .scaleMatRcpp(X, seq.int(0, nr ...
R/storm.R#L37   X <- X_sc[[1]] ...
R/storm.R#L38   ref.idx <- get_idx(range=shift, ppm) ...
R/storm.R#L39   ref <- X[idx.refSpec, ref.idx] ...
R/storm.R#L41   # init ...
R/storm.R#L42   subset <- 0 ...
R/storm.R#L43   subset1 <- seq_len(nrow(X)) ...
R/storm.R#L44   i <- 1 ...
R/storm.R#L46   # perform storm ...
R/storm.R#L47   while(length(which(!subset %in% subset ...
R/storm.R#L50       message("STORM reduced to a single ...
R/storm.R#L51       break ...
R/storm.R#L85   } ...
R/storm.R#L86   return(subset1) ...
vignettes/MVA.Rmd#L17   collapse = TRUE, ...
vignettes/MVA.Rmd#L18   comment = "#>", ...
vignettes/MVA.Rmd#L19   eval = requireNamespace("nmrdata", qui ...
vignettes/MVA.Rmd#L27   message("The 'yourGitHubPackage' packa ...
vignettes/MVA.Rmd#L29   library(nmrdata) ...
vignettes/MVA.Rmd#L44  Here, pre-processed data are imported. ...
vignettes/MVA.Rmd#L120   obj=pca_model,  ...
vignettes/MVA.Rmd#L121   pc=c(1,2),  ...
vignettes/MVA.Rmd#L122   an=list( ...
vignettes/MVA.Rmd#L126   ),   ...
vignettes/MVA.Rmd#L127   title='PCA - Scores plot') ...
vignettes/MVA.Rmd#L141          pc = 2,  ...
vignettes/MVA.Rmd#L142          shift = c(7.4, 7.6), ...
vignettes/MVA.Rmd#L143          an=list( ...
vignettes/MVA.Rmd#L148          ) ...
vignettes/MVA.Rmd#L205   Surgery=an$Class[idx],          # colo ...
vignettes/MVA.Rmd#L206   Timepoint=an$Timepoint[idx]),   # line ...
vignettes/MVA.Rmd#L207   title='OPLS - Scores plot',     # plot ...
vignettes/MVA.Rmd#L208   cv.scores = TRUE)               # visu ...
vignettes/MVA.Rmd#L225   facet=an$Class[idx]),  ...
vignettes/MVA.Rmd#L226   type='backscaled',  ...
vignettes/MVA.Rmd#L227   alp = 0.5,  ...
vignettes/MVA.Rmd#L228   title = 'Overlayed Spectra with Backsc ...
vignettes/PreProc.Rmd#L17   collapse = TRUE, ...
vignettes/PreProc.Rmd#L18   comment = "#>", ...
vignettes/PreProc.Rmd#L19   eval = requireNamespace("nmrData", qui ...
vignettes/PreProc.Rmd#L27   message("The 'yourGitHubPackage' packa ...
vignettes/PreProc.Rmd#L29   library(nmrdata) ...
vignettes/PreProc.Rmd#L79              'Description'=c('Matrix of  ...
vignettes/PreProc.Rmd#L80                              'Array of c ...
vignettes/PreProc.Rmd#L81                              'Dataframe  ...
vignettes/PreProc.Rmd#L127              'RunOrder'=meta$runOrder, # ...
vignettes/PreProc.Rmd#L128              'Pulse Program'=meta$a_PULP ...
vignettes/PreProc.Rmd#L166              'Receiver Gain'=meta$a_RG,  ...
vignettes/PreProc.Rmd#L167              'Pulse Program'=meta$a_PULP ...
vignettes/PreProc.Rmd#L188    ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
Checking for version number mismatch... OK
