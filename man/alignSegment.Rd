% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/alignSegment.R
\name{alignSegment}
\alias{alignSegment}
\title{Align NMR Spectra via Cross-Correlation}
\usage{
alignSegment(seg, idx_ref = 1, clim = 0.7, med = TRUE, norm = FALSE)
}
\arguments{
\item{seg}{Numeric matrix. Each row is a 1D NMR spectrum segment.}

\item{idx_ref}{Integer. Row index to use as reference spectrum. Ignored if \code{med = TRUE}.}

\item{clim}{Numeric. Minimum cross-correlation threshold. Segments with lower similarity are not shifted.}

\item{med}{Logical. If \code{TRUE}, the row-wise median spectrum is used as the reference.}

\item{norm}{Logical. If \code{TRUE}, rows are scaled to the \link{0, 1} range using min-max scaling before alignment.}
}
\value{
A numeric matrix of aligned spectra with the same dimensions as \code{seg}.
If \code{med = TRUE}, the output excludes the median row.
}
\description{
Aligns rows of an NMR spectral matrix to a reference spectrum by maximizing cross-correlation.
Optionally uses the row-wise median spectrum as reference. Useful for minor spectral misalignments.
}
\details{
Each spectrum is aligned to the reference by computing the cross-correlation and applying a lag-based circular shift.
The shift is applied only if the cross-correlation exceeds \code{clim}.
This function is intended for fine-tuning alignment across short ppm windows (i.e., segments).
}
\examples{
set.seed(1)
x <- matrix(rnorm(1000), nrow = 10)
x[5, ] <- x[1, ] + 0.1  # Simulate minor shift
aligned <- alignSegment(x, clim = 0.6)

}
\seealso{
\code{\link{minmax}}

Other NMR: 
\code{\link{binning}()},
\code{\link{cvanova}()},
\code{\link{get_idx}()},
\code{\link{lw}()},
\code{\link{matspec}()},
\code{\link{noise.est}()},
\code{\link{normErectic}()},
\code{\link{read1d}()},
\code{\link{read1d_raw}()},
\code{\link{stocsy1d_metabom8-class}},
\code{\link{storm}()}
}
\concept{NMR}
