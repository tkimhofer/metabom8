% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibrate.R
\name{calibrate}
\alias{calibrate}
\title{Chemical Shift Calibration}
\usage{
calibrate(X, ppm, type = c("tsp", "glucose", "alanine"))
}
\arguments{
\item{X}{Numeric matrix. NMR data matrix with spectra in rows and chemical shift positions in columns.}

\item{ppm}{Numeric vector. Chemical shift values corresponding to the columns of \code{X}.}

\item{type}{Either a character string or numeric vector. Options include:
\itemize{
\item{\code{"tsp"}: calibrates to 0 ppm using the highest peak in the interval \code{[-0.2, 0.2]} ppm (TSP signal).}
\item{\code{"glucose"}: calibrates to 5.23 ppm using glucose doublet (5.15–5.30 ppm).}
\item{\code{"alanine"}: calibrates to 1.48 ppm using alanine doublet (1.40–1.53 ppm).}
\item{Numeric vector of length 2: custom ppm range. Spectrum is shifted so the maximum peak in this interval aligns with \code{mean(type)}.}
}}
}
\value{
A numeric matrix of the same dimensions as \code{X}, with spectra calibrated to the chosen reference.
}
\description{
Chemical shift calibration using a reference signal for 1D NMR spectra.
}
\details{
Calibration is typically part of the technical quality control pipeline and is commonly done using a reference signal such as TSP at 0 ppm.
}
\examples{
data(covid_raw)
X <- covid_raw$X
ppm <- covid_raw$ppm
X_tsp <- calibrate(X, ppm, type = "tsp")
X_glu <- calibrate(X, ppm, type = "glucose")
X_custom <- calibrate(X, ppm, type = c(1.9, 2.1))

}
\references{
Dona, A.C., \emph{et al.} (2014). Precision high-throughput proton NMR spectroscopy of human urine, serum, and plasma for large-scale metabolic phenotyping. \emph{Analytical Chemistry}, 86(19), 9887–9894.
}
\seealso{
\code{\link{.calibrate_doub}}
}
