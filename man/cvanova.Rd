% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cvanova.R
\name{cvanova}
\alias{cvanova}
\title{Cross-validated ANOVA for O-PLS models}
\usage{
cvanova(smod)
}
\arguments{
\item{smod}{An object of class \code{OPLS_metabom8}, generated by functions in the \pkg{metabom8} package.}
}
\value{
A \code{data.frame} containing:
\itemize{
\item \code{SS} - Sum of Squares
\item \code{DF} - Degrees of Freedom
\item \code{MS} - Mean Squares
\item \code{F_value} - F statistic
\item \code{p_value} - P-value from the F-test
}
}
\description{
Performs a cross-validated ANOVA (CV-ANOVA) test for OPLS models. The function compares residuals from a null model and a model using cross-validated predictive scores to assess the significance of the OPLS model.
}
\details{
CV-ANOVA formally compares the fit of two linear models using the size of their residuals.
The null model regresses the response on an intercept only:
\deqn{Y_i = \beta_0 + \epsilon_i}
The full model includes the cross-validated predictive scores:
\deqn{Y_i = \beta_0 + \beta_1 t_{\text{pred},i} + \epsilon_i}
Here, \eqn{Y_i} is the response for observation \eqn{i}, \eqn{t_{\text{pred},i}} the cross-validated predictive score, and \eqn{\epsilon_i} are residuals.
The residual sums of squares (SS) and degrees of freedom (DF) from both models are used to calculate an F-statistic and associated p-value to assess if the OPLS model significantly improves the fit.

Please note: larger sample sizes increase the power to detect true effects. With few samples, even strong models may not reach statistical significance.
}
\examples{
data("covid")
mod <- opls(X, an$type)
cvanova(mod)

# Internally, two linear models are fitted:
# Null model: lm(Y ~ 1)
# Full model: lm(Y ~ 1 + t_pred_cv)
#
# where Y is the response variable and t_pred_cv the cross-validated predictive scores.

}
\references{
Eriksson, L., et al. (2008). CV-ANOVA for significance testing of PLS and OPLS models. \emph{Journal of Chemometrics}, 22(11-12), 594â€“600.
}
\seealso{
\code{\link{opls}}, \code{\link{dmodx}}

Other NMR: 
\code{\link{alignSegment}()},
\code{\link{binning}()},
\code{\link{get_idx}()},
\code{\link{lw}()},
\code{\link{matspec}()},
\code{\link{noise.est}()},
\code{\link{normErectic}()},
\code{\link{read1d}()},
\code{\link{read1d_raw}()},
\code{\link{stocsy1d_metabom8-class}},
\code{\link{storm}()}
}
\concept{NMR}
