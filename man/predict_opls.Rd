% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_opls.R
\name{predict_opls}
\alias{predict_opls}
\title{Predict New Data Using an OPLS Model}
\usage{
predict_opls(opls_model, newdata, idx_scale = NULL)
}
\arguments{
\item{opls_model}{An object of class \code{OPLS_metabom8}, generated by the \code{opls()} function.}

\item{newdata}{A numeric matrix or data.frame. Each row is a new observation and columns must match those used in the model.}

\item{idx_scale}{Optional integer vector. Row indices of \code{newdata} used to compute new centering/scaling parameters. If \code{NULL}, model parameters are reused.}
}
\value{
A named list with the following elements:
\describe{
\item{Y_predicted}{Predicted numeric or class outcomes (depending on model type).}
\item{t_pred}{Predicted scores for the predictive component(s).}
\item{t_orth}{Scores for orthogonal components (uncorrelated variation).}
\item{t_orth_pca}{Optional: scores of the first principal component of orthogonal scores (if >1 orthogonal component).}
}
}
\description{
Generates predictions (scores and outcome estimates) using an existing OPLS model fitted with \code{opls()}. Supports regression and 2-class discriminant analysis.
}
\details{
Class predictions are based on the closest numeric projection from the training labels and are not corrected for class imbalance.
If more than one orthogonal component is present, the PCA of orthogonal scores is computed to summarise variation orthogonal to Y.
}
\examples{
data(covid)
X <- covid$X
an <- covid$an

model <- opls(X, Y = an$type)
preds <- predict_opls(model, X)
table(preds$Y_predicted, an$type)

}
\references{
Trygg J. and Wold S. (2002). Orthogonal projections to latent structures (O-PLS). \emph{Journal of Chemometrics}, 16(3), 119–128.
Geladi P. and Kowalski B.R. (1986). Partial least squares and regression: a tutorial. \emph{Analytica Chimica Acta}, 185, 1–17.
}
\seealso{
\code{\link{opls}}, \code{\link{pca}}, \code{\link{plotscores}}
}
