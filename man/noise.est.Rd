% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R
\name{noise.est}
\alias{noise.est}
\title{Estimate Noise Level in 1D NMR Spectra}
\usage{
noise.est(X, ppm, where = c(14.6, 14.7))
}
\arguments{
\item{X}{Numeric matrix. NMR data with spectra represented in rows (samples Ã— chemical shift bins).}

\item{ppm}{Numeric vector. Chemical shift positions in ppm. Must match the number of columns in \code{X}.}

\item{where}{Numeric vector of length 2. Specifies the ppm range to use for noise estimation.
This range should be free of peaks (i.e., no expected metabolite signal). Default is \code{c(14.6, 14.7)}.}
}
\value{
Numeric vector of noise levels, one value per spectrum (length equals \code{nrow(X)}).
}
\description{
Estimates the noise level for each spectrum in a 1D NMR dataset by analyzing a signal-free region.
Useful for quality control (QC) before or after spectral processing such as normalization or baseline correction.
}
\details{
Noise is estimated after baseline correction using asymmetric least squares smoothing
(via \code{\link[ptw]{asysm}}). The output is based on the 95th percentile of the signal in the specified
region and assumes a minimum of 50 points in that region. If fewer points are available, the function stops.
}
\note{
Choose the \code{where} region carefully based on acquisition setup.
Signal-free regions are typically at the high or low ppm ends (e.g., >10 ppm or <0 ppm).
}
\examples{
data(covid_raw)
X <- covid_raw$X
ppm <- covid_raw$ppm
noise_vals <- noise.est(X, ppm, where = c(8.8, 8.9))
hist(noise_vals, main = "Estimated Noise", xlab = "Noise Level")

}
\seealso{
Other NMR: 
\code{\link{alignSegment}()},
\code{\link{binning}()},
\code{\link{cvanova}()},
\code{\link{get_idx}()},
\code{\link{lw}()},
\code{\link{matspec}()},
\code{\link{normErectic}()},
\code{\link{read1d}()},
\code{\link{read1d_raw}()},
\code{\link{stocsy1d_metabom8-class}},
\code{\link{storm}()}
}
\concept{NMR}
