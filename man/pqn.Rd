% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pqn.R
\name{pqn}
\alias{pqn}
\title{Probabilistic Quotient Normalisation (PQN)}
\usage{
pqn(X, iref = NULL, TArea = FALSE, add_DilF = "dquot", bin = NULL)
}
\arguments{
\item{X}{A numeric matrix or data.frame. Each row is a sample spectrum, and each column is a chemical shift variable.}

\item{iref}{Integer vector of row indices in \code{X} used to compute the reference spectrum. If \code{NULL}, all rows are used.}

\item{TArea}{Logical. If \code{TRUE}, total area normalisation is applied before PQN.}

\item{add_DilF}{Character. Name of global variable to store dilution factors. Set to \code{NULL} to disable.}

\item{bin}{Optional named list for binning (e.g., \code{list(ppm = ppm, width = 0.05)}). If \code{NULL}, binning is not applied.}
}
\value{
A matrix with the same dimensions as \code{X}, containing PQN-normalised spectra.
}
\description{
Applies probabilistic quotient normalisation (PQN) to NMR spectra, optionally preceded by total area normalisation and binning.
}
\details{
PQN accounts for sample dilution effects by normalising each spectrum using the median quotient relative to a reference spectrum. This reference is typically the median spectrum of QC samples or the entire dataset.

Total area normalisation (\code{TArea = TRUE}) may help standardise sample intensities, but can distort profiles in some cases.

If binning is applied, the function uses a reference spectrum computed on binned data.
}
\examples{
data(covid)
X <- covid$X

Xn <- pqn(X, add_DilF = "dilutionFactor")
plot(dilutionFactor)

}
\references{
Dieterle F, Ross A, Schlotterbeck G, Senn H (2006). Probabilistic Quotient Normalization as Robust Method to Account for Dilution of Complex Biological Mixtures. \emph{Analytical Chemistry}, 78(13), 4281â€“4290.
}
\concept{NMR preprocessing}
