% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R
\name{lw}
\alias{lw}
\title{Full Width at Half Maximum (FWHM) Estimation}
\usage{
lw(X, ppm, shift = c(-0.1, 0.1), sf)
}
\arguments{
\item{X}{Numeric matrix. NMR spectral data with rows as spectra and columns as chemical shift (ppm) variables.}

\item{ppm}{Numeric vector. Chemical shift axis corresponding to columns of \code{X}.}

\item{shift}{Numeric vector of length 2. Chemical shift range that includes the singlet peak (e.g., \code{c(-0.1, 0.1)} for TSP).}

\item{sf}{Numeric scalar. Spectrometer frequency in MHz (e.g., 600 for 600 MHz).}
}
\value{
Numeric vector. FWHM in Hz, one value per row in \code{X}.
}
\description{
Calculates the full width at half maximum (FWHM, or line width) of a peak
within a specified chemical shift range in each NMR spectrum.
}
\details{
For each spectrum, the function extracts the region defined by \code{shift},
interpolates the signal, identifies the full width at half maximum (FWHM),
and converts the width from ppm to Hz using \code{sf}.

This is commonly used as part of technical QC for NMR data, especially for evaluating the TSP reference peak,
where a sharp peak implies good resolution and field homogeneity.
}
\note{
The chemical shift axis direction is auto-detected. If a spectrum does not have a clear half-maximum width,
\code{NA} is returned for that spectrum.
}
\examples{
# Simulated data example
ppm <- seq(-0.2, 0.2, length.out = 1000)
X <- matrix(dnorm(ppm, mean = 0, sd = 0.02), nrow = 10, byrow = TRUE)
sf <- 600  # MHz
fwhm_vals <- lw(X, ppm, shift = c(-0.1, 0.1), sf = sf)
hist(fwhm_vals, main = "Line Width (Hz)", xlab = "FWHM [Hz]")

}
\seealso{
\code{\link{get_idx}}

Other NMR: 
\code{\link{alignSegment}()},
\code{\link{binning}()},
\code{\link{cvanova}()},
\code{\link{get_idx}()},
\code{\link{matspec}()},
\code{\link{noise.est}()},
\code{\link{normErectic}()},
\code{\link{read1d}()},
\code{\link{read1d_raw}()},
\code{\link{stocsy1d_metabom8-class}},
\code{\link{storm}()}
}
\concept{NMR}
